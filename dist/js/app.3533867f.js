(function(){"use strict";var a={4975:function(a,e,t){var s=t(5130),l=t(6768),n=t(144),o=t(1387);const i={class:"navbar"},r={class:"nav-links"},d={class:"user-actions"};var c={__name:"NavBar",setup(a){return(a,e)=>((0,l.uX)(),(0,l.CE)("nav",i,[e[12]||(e[12]=(0,l.Lk)("div",{class:"logo"},[(0,l.Lk)("img",{class:"logo-img",src:"http://www.chayuzhiyun.top/logo.png",alt:"Logo"}),(0,l.Lk)("span",{class:"logo-text"},"智能茶园系统")],-1)),(0,l.Lk)("ul",r,[(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{class:"nav-link",to:"/home"},{default:(0,l.k6)(()=>e[0]||(e[0]=[(0,l.eW)("首页",-1)])),_:1,__:[0]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{class:"nav-link",to:"/manage"},{default:(0,l.k6)(()=>e[1]||(e[1]=[(0,l.eW)("茶园管理",-1)])),_:1,__:[1]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{class:"nav-link",to:"/dashboard"},{default:(0,l.k6)(()=>e[2]||(e[2]=[(0,l.eW)("数据中枢",-1)])),_:1,__:[2]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{class:"nav-link",to:"/monitor"},{default:(0,l.k6)(()=>e[3]||(e[3]=[(0,l.eW)("历史查询",-1)])),_:1,__:[3]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{class:"nav-link",to:"/solutions"},{default:(0,l.k6)(()=>e[4]||(e[4]=[(0,l.eW)("AI Agent 智能体",-1)])),_:1,__:[4]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{class:"nav-link",to:"/solutions"},{default:(0,l.k6)(()=>e[5]||(e[5]=[(0,l.eW)("茶园运营",-1)])),_:1,__:[5]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{class:"nav-link",to:"/solutions"},{default:(0,l.k6)(()=>e[6]||(e[6]=[(0,l.eW)("设备与任务",-1)])),_:1,__:[6]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{class:"nav-link",to:"/solutions"},{default:(0,l.k6)(()=>e[7]||(e[7]=[(0,l.eW)("用户与系统",-1)])),_:1,__:[7]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{class:"nav-link",to:"/solutions"},{default:(0,l.k6)(()=>e[8]||(e[8]=[(0,l.eW)("系统设置",-1)])),_:1,__:[8]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{class:"nav-link",to:"/person"},{default:(0,l.k6)(()=>e[9]||(e[9]=[(0,l.eW)("个人中心",-1)])),_:1,__:[9]})])]),(0,l.Lk)("div",d,[(0,l.bF)((0,n.R1)(o.Wk),{class:"login-btn",to:"/"},{default:(0,l.k6)(()=>e[10]||(e[10]=[(0,l.eW)("登录",-1)])),_:1,__:[10]}),(0,l.bF)((0,n.R1)(o.Wk),{class:"register-btn",to:"/?register=true"},{default:(0,l.k6)(()=>e[11]||(e[11]=[(0,l.eW)("注册",-1)])),_:1,__:[11]})])]))}},u=t(1241);const v=(0,u.A)(c,[["__scopeId","data-v-4678af50"]]);var p=v,m={__name:"App",setup(a){return(a,e)=>{const t=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.CE)(l.FK,null,[!1!==a.$route.meta.showNavbar?((0,l.uX)(),(0,l.Wv)(p,{key:0})):(0,l.Q3)("",!0),(0,l.bF)(t)],64)}}};const h=m;var b=h,k=t(4232);const g={class:"home-view"},f={class:"hero-section"},L={class:"hero-content"},_={class:"hero-buttons"},y={class:"product-showcase"},w={class:"product-grid"},C={class:"product-image"},F=["src","alt"],R={class:"product-features"},x={class:"cases-section"},D={class:"cases-grid"},E={class:"case-card"},W={class:"case-content"},I={class:"case-card"},S={class:"case-content"},T={class:"app-footer"},$={class:"footer-content"},A={class:"footer-section"},V={class:"footer-section"},M={class:"footer-bottom"},X={class:"footer-links"};var K={__name:"HomeView",setup(a){(0,n.KR)(!1),(0,n.KR)({name:"用户"});const e=(0,l.EW)(()=>(new Date).getFullYear()),t=(0,n.KR)([{id:1,name:"智能监测系统",description:"实时监控茶园环境参数，为茶叶生长提供科学依据",color:"#8BC34A",imageUrl:"https://placeholder-for-product1.jpg",features:["多参数同步监测","低功耗设计","IP67防水等级","云端数据存储"]},{id:2,name:"精准灌溉设备",description:"根据土壤湿度自动调节灌溉，节约用水提高效率",color:"#2196F3",imageUrl:"https://placeholder-for-product2.jpg",features:["智能流量控制","分区独立管理","用水量统计分析","远程控制功能"]},{id:3,name:"作物生长模型",description:"预测作物生长周期和产量，优化种植计划",color:"#FF9800",imageUrl:"https://placeholder-for-product3.jpg",features:["AI产量预测","病虫害预警","采摘时间建议","生长趋势分析"]},{id:4,name:"茶园管理平台",description:"整合所有设备数据，一站式管理茶园生产",color:"#9C27B0",imageUrl:"https://placeholder-for-product4.jpg",features:["数据可视化仪表盘","多设备集中控制","生产计划管理","移动端实时查看"]}]);return(a,s)=>((0,l.uX)(),(0,l.CE)("div",g,[(0,l.Lk)("section",f,[(0,l.Lk)("div",L,[s[2]||(s[2]=(0,l.Lk)("h1",null,"茶语智韵欢迎你！",-1)),s[3]||(s[3]=(0,l.Lk)("p",null,"重新定义智慧茶园管理方式，让每一片茶叶都茁壮成长",-1)),(0,l.Lk)("div",_,[(0,l.bF)((0,n.R1)(o.Wk),{class:"primary-btn",to:"/products"},{default:(0,l.k6)(()=>s[0]||(s[0]=[(0,l.eW)("探索产品",-1)])),_:1,__:[0]}),(0,l.bF)((0,n.R1)(o.Wk),{class:"secondary-btn",to:"/technology"},{default:(0,l.k6)(()=>s[1]||(s[1]=[(0,l.eW)("了解技术",-1)])),_:1,__:[1]})])]),s[4]||(s[4]=(0,l.Lk)("div",{class:"hero-image"},[(0,l.Lk)("img",{src:"https://placeholder-for-hero-image.jpg",alt:"智能茶园系统展示"})],-1))]),s[33]||(s[33]=(0,l.Fv)('<section class="features-section" data-v-b490bc68><div class="section-header" data-v-b490bc68><h2 data-v-b490bc68>智慧茶园解决方案</h2><p data-v-b490bc68>融合物联网、人工智能与农业技术，打造现代化茶园管理体系</p></div><div class="features-grid" data-v-b490bc68><div class="feature-card" data-v-b490bc68><div class="feature-icon" data-v-b490bc68><img src="https://placeholder-for-sensing-icon.png" alt="智能感知" data-v-b490bc68></div><h3 data-v-b490bc68>智能环境感知</h3><p data-v-b490bc68>24小时监测温度、湿度、光照、土壤养分等关键参数，数据精度达98%以上</p></div><div class="feature-card" data-v-b490bc68><div class="feature-icon" data-v-b490bc68><img src="https://placeholder-for-ai-icon.png" alt="AI分析" data-v-b490bc68></div><h3 data-v-b490bc68>AI生长分析</h3><p data-v-b490bc68>基于机器学习的作物生长模型，精准预测生长周期，提前预警病虫害风险</p></div><div class="feature-card" data-v-b490bc68><div class="feature-icon" data-v-b490bc68><img src="https://placeholder-for-auto-icon.png" alt="自动控制" data-v-b490bc68></div><h3 data-v-b490bc68>自动化管理</h3><p data-v-b490bc68>根据环境数据自动调节灌溉、施肥和遮阳，减少人工成本达70%以上</p></div><div class="feature-card" data-v-b490bc68><div class="feature-icon" data-v-b490bc68><img src="https://placeholder-for-data-icon.png" alt="数据管理" data-v-b490bc68></div><h3 data-v-b490bc68>全周期数据管理</h3><p data-v-b490bc68>记录从种植到收获的全过程数据，生成生长报告和优化建议</p></div></div></section>',1)),(0,l.Lk)("section",y,[s[6]||(s[6]=(0,l.Lk)("div",{class:"section-header"},[(0,l.Lk)("h2",null,"特色产品系列"),(0,l.Lk)("p",null,"为不同规模茶园提供定制化智能解决方案")],-1)),(0,l.Lk)("div",w,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(t.value,a=>((0,l.uX)(),(0,l.CE)("div",{key:a.id,class:"product-card"},[(0,l.Lk)("div",C,[(0,l.Lk)("img",{src:a.imageUrl,alt:a.name},null,8,F)]),(0,l.Lk)("div",{class:"color-block",style:(0,k.Tr)({background:a.color})},null,4),(0,l.Lk)("h3",null,(0,k.v_)(a.name),1),(0,l.Lk)("p",null,(0,k.v_)(a.description),1),(0,l.Lk)("div",R,[(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.features,(a,e)=>((0,l.uX)(),(0,l.CE)("li",{key:e},(0,k.v_)(a),1))),128))])]),(0,l.bF)((0,n.R1)(o.Wk),{class:"secondary-btn",to:`/products/${a.id}`},{default:(0,l.k6)(()=>s[5]||(s[5]=[(0,l.eW)("查看详情",-1)])),_:2,__:[5]},1032,["to"])]))),128))])]),s[34]||(s[34]=(0,l.Fv)('<section class="specs-section" data-v-b490bc68><div class="section-header" data-v-b490bc68><h2 data-v-b490bc68>技术参数对比</h2><p data-v-b490bc68>选择最适合您茶园需求的智能系统</p></div><div class="specs-table-container" data-v-b490bc68><table class="specs-table" data-v-b490bc68><thead data-v-b490bc68><tr data-v-b490bc68><th data-v-b490bc68>技术参数</th><th data-v-b490bc68>智能监测系统</th><th data-v-b490bc68>精准灌溉设备</th><th data-v-b490bc68>作物生长模型</th></tr></thead><tbody data-v-b490bc68><tr data-v-b490bc68><td data-v-b490bc68>监测范围</td><td data-v-b490bc68>温度、湿度、光照、CO₂</td><td data-v-b490bc68>土壤湿度、酸碱度</td><td data-v-b490bc68>生长周期、产量预测</td></tr><tr data-v-b490bc68><td data-v-b490bc68>数据传输</td><td data-v-b490bc68>4G/5G/Wi-Fi</td><td data-v-b490bc68>4G/5G/Wi-Fi</td><td data-v-b490bc68>云端同步</td></tr><tr data-v-b490bc68><td data-v-b490bc68>续航时间</td><td data-v-b490bc68>6-12个月</td><td data-v-b490bc68>持续供电</td><td data-v-b490bc68>无限制</td></tr><tr data-v-b490bc68><td data-v-b490bc68>适用面积</td><td data-v-b490bc68>单设备覆盖500㎡</td><td data-v-b490bc68>单系统覆盖1000㎡</td><td data-v-b490bc68>无限制</td></tr></tbody></table></div></section>',1)),(0,l.Lk)("section",x,[s[15]||(s[15]=(0,l.Lk)("div",{class:"section-header"},[(0,l.Lk)("h2",null,"成功案例"),(0,l.Lk)("p",null,"来自全国各地茶园的应用反馈")],-1)),(0,l.Lk)("div",D,[(0,l.Lk)("div",E,[s[10]||(s[10]=(0,l.Lk)("img",{src:"https://placeholder-for-case1.jpg",alt:"案例图片",class:"case-image"},null,-1)),(0,l.Lk)("div",W,[s[8]||(s[8]=(0,l.Lk)("h3",null,"西湖龙井茶园",-1)),s[9]||(s[9]=(0,l.Lk)("p",null,"应用智能监测系统后，茶叶品质提升15%，用水量减少30%，人力成本降低60%",-1)),(0,l.bF)((0,n.R1)(o.Wk),{to:"/cases/1",class:"case-link"},{default:(0,l.k6)(()=>s[7]||(s[7]=[(0,l.eW)("查看详情 →",-1)])),_:1,__:[7]})])]),(0,l.Lk)("div",I,[s[14]||(s[14]=(0,l.Lk)("img",{src:"https://placeholder-for-case2.jpg",alt:"案例图片",class:"case-image"},null,-1)),(0,l.Lk)("div",S,[s[12]||(s[12]=(0,l.Lk)("h3",null,"安溪铁观音基地",-1)),s[13]||(s[13]=(0,l.Lk)("p",null,"全系列产品应用，实现亩产提升20%，病虫害发生率下降80%，能源消耗降低40%",-1)),(0,l.bF)((0,n.R1)(o.Wk),{to:"/cases/2",class:"case-link"},{default:(0,l.k6)(()=>s[11]||(s[11]=[(0,l.eW)("查看详情 →",-1)])),_:1,__:[11]})])])])]),s[35]||(s[35]=(0,l.Fv)('<section class="testimonials-section" data-v-b490bc68><div class="section-header" data-v-b490bc68><h2 data-v-b490bc68>客户评价</h2><p data-v-b490bc68>听听他们怎么说</p></div><div class="testimonials-grid" data-v-b490bc68><div class="testimonial-card" data-v-b490bc68><div class="testimonial-text" data-v-b490bc68> &quot;茶语智韵的智能系统彻底改变了我们的管理方式，现在即使不在茶园，也能实时掌握所有情况，决策更精准。&quot; </div><div class="testimonial-author" data-v-b490bc68><img src="https://placeholder-for-user1.jpg" alt="用户头像" data-v-b490bc68><div data-v-b490bc68><h4 data-v-b490bc68>张经理</h4><p data-v-b490bc68>黄山毛峰茶园</p></div></div></div><div class="testimonial-card" data-v-b490bc68><div class="testimonial-text" data-v-b490bc68> &quot;精准灌溉设备帮我们节省了大量水资源，同时茶叶品质更加稳定，客户反馈非常好，值得投资。&quot; </div><div class="testimonial-author" data-v-b490bc68><img src="https://placeholder-for-user2.jpg" alt="用户头像" data-v-b490bc68><div data-v-b490bc68><h4 data-v-b490bc68>李老板</h4><p data-v-b490bc68>武夷岩茶合作社</p></div></div></div><div class="testimonial-card" data-v-b490bc68><div class="testimonial-text" data-v-b490bc68> &quot;生长模型预测非常准确，让我们能够提前安排采摘和销售计划，经济效益提升明显。&quot; </div><div class="testimonial-author" data-v-b490bc68><img src="https://placeholder-for-user3.jpg" alt="用户头像" data-v-b490bc68><div data-v-b490bc68><h4 data-v-b490bc68>王教授</h4><p data-v-b490bc68>茶叶研究所</p></div></div></div></div></section><section class="contact-section" data-v-b490bc68><div class="contact-content" data-v-b490bc68><h2 data-v-b490bc68>获取专属茶园解决方案</h2><p data-v-b490bc68>填写下方表单，我们的技术顾问将为您提供定制化建议</p><form class="contact-form" data-v-b490bc68><div class="form-group" data-v-b490bc68><label for="name" data-v-b490bc68>姓名</label><input type="text" id="name" placeholder="请输入您的姓名" data-v-b490bc68></div><div class="form-group" data-v-b490bc68><label for="phone" data-v-b490bc68>电话</label><input type="tel" id="phone" placeholder="请输入您的联系电话" data-v-b490bc68></div><div class="form-group" data-v-b490bc68><label for="茶园面积" data-v-b490bc68>茶园面积</label><input type="text" id="茶园面积" placeholder="请输入您的茶园面积" data-v-b490bc68></div><div class="form-group" data-v-b490bc68><label for="需求" data-v-b490bc68>主要需求</label><textarea id="需求" rows="4" placeholder="请描述您的主要需求" data-v-b490bc68></textarea></div><button type="submit" class="primary-btn" data-v-b490bc68>提交咨询</button></form></div><div class="contact-image" data-v-b490bc68><img src="https://placeholder-for-contact-image.jpg" alt="专业咨询" data-v-b490bc68></div></section>',2)),(0,l.Lk)("footer",T,[(0,l.Lk)("div",$,[s[26]||(s[26]=(0,l.Fv)('<div class="footer-section" data-v-b490bc68><h3 data-v-b490bc68>关于我们</h3><p data-v-b490bc68>致力于发展智慧茶园，为茶叶产业提供全方位的智能化解决方案，推动传统农业向现代农业转型。</p><div class="social-links" data-v-b490bc68><a href="#" data-v-b490bc68><img src="https://placeholder-for-weixin.png" alt="微信" data-v-b490bc68></a><a href="#" data-v-b490bc68><img src="https://placeholder-for-weibo.png" alt="微博" data-v-b490bc68></a><a href="#" data-v-b490bc68><img src="https://placeholder-for-youtube.png" alt="YouTube" data-v-b490bc68></a></div></div>',1)),(0,l.Lk)("div",A,[s[20]||(s[20]=(0,l.Lk)("h3",null,"产品中心",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{to:"/products/1"},{default:(0,l.k6)(()=>s[16]||(s[16]=[(0,l.eW)("智能监测系统",-1)])),_:1,__:[16]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{to:"/products/2"},{default:(0,l.k6)(()=>s[17]||(s[17]=[(0,l.eW)("精准灌溉设备",-1)])),_:1,__:[17]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{to:"/products/3"},{default:(0,l.k6)(()=>s[18]||(s[18]=[(0,l.eW)("作物生长模型",-1)])),_:1,__:[18]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{to:"/products/4"},{default:(0,l.k6)(()=>s[19]||(s[19]=[(0,l.eW)("茶园管理平台",-1)])),_:1,__:[19]})])])]),(0,l.Lk)("div",V,[s[25]||(s[25]=(0,l.Lk)("h3",null,"技术支持",-1)),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{to:"/support/manual"},{default:(0,l.k6)(()=>s[21]||(s[21]=[(0,l.eW)("用户手册",-1)])),_:1,__:[21]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{to:"/support/video"},{default:(0,l.k6)(()=>s[22]||(s[22]=[(0,l.eW)("教学视频",-1)])),_:1,__:[22]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{to:"/support/faq"},{default:(0,l.k6)(()=>s[23]||(s[23]=[(0,l.eW)("常见问题",-1)])),_:1,__:[23]})]),(0,l.Lk)("li",null,[(0,l.bF)((0,n.R1)(o.Wk),{to:"/support/contact"},{default:(0,l.k6)(()=>s[24]||(s[24]=[(0,l.eW)("联系客服",-1)])),_:1,__:[24]})])])]),s[27]||(s[27]=(0,l.Lk)("div",{class:"footer-section"},[(0,l.Lk)("h3",null,"联系我们"),(0,l.Lk)("p",null,"地址：杭州市西湖区科技园A座15层"),(0,l.Lk)("p",null,"电话：400-888-9999"),(0,l.Lk)("p",null,"邮箱：info@chayuzhiyun.com")],-1))]),(0,l.Lk)("div",M,[(0,l.Lk)("p",null,"©"+(0,k.v_)(e.value)+" 茶语智韵. 保留所有权利.",1),(0,l.Lk)("div",X,[(0,l.bF)((0,n.R1)(o.Wk),{to:"/privacy"},{default:(0,l.k6)(()=>s[28]||(s[28]=[(0,l.eW)("隐私政策",-1)])),_:1,__:[28]}),s[31]||(s[31]=(0,l.eW)(" | ",-1)),(0,l.bF)((0,n.R1)(o.Wk),{to:"/terms"},{default:(0,l.k6)(()=>s[29]||(s[29]=[(0,l.eW)("使用条款",-1)])),_:1,__:[29]}),s[32]||(s[32]=(0,l.eW)(" | ",-1)),(0,l.bF)((0,n.R1)(o.Wk),{to:"/sitemap"},{default:(0,l.k6)(()=>s[30]||(s[30]=[(0,l.eW)("网站地图",-1)])),_:1,__:[30]})])])])]))}};const P=(0,u.A)(K,[["__scopeId","data-v-b490bc68"]]);var B=P;t(4114);const U={class:"auth-container"},Y={class:"auth-wrapper"},z={class:"auth-box"},q={class:"auth-title"},H={class:"form-group"},j=["placeholder"],N={class:"form-group"},O=["type","placeholder"],G={key:0,class:"form-group"},Q={type:"submit",class:"submit-btn"},J={class:"btn-text"};var Z={__name:"AuthView",setup(a){const e=(0,o.lq)(),t=(0,o.rd)(),i=(0,n.KR)(!0),r=(0,n.KR)(!1),d=(0,n.KR)(""),c=(0,n.KR)({username:"",password:"",confirmPassword:""});(0,l.sV)(()=>{"true"===e.query.register&&(i.value=!1),document.body.classList.add("page-loaded")});const u=()=>{if(d.value="",c.value.username)if(c.value.password){if(!i.value){if(c.value.password!==c.value.confirmPassword)return void(d.value="两次密码不一致");if(c.value.username.length<6||c.value.username.length>12)return void(d.value="用户名长度必须在6-12位之间");if(c.value.password.length<6||c.value.password.length>16)return void(d.value="密码长度必须在6-16位之间")}if(i.value){const a=document.querySelector(".auth-box");a.classList.add("success-animation"),setTimeout(()=>{t.push("/home")},800)}else i.value=!0,d.value="注册成功，请登录",c.value={username:c.value.username,password:"",confirmPassword:""}}else d.value=i.value?"请输入密码":"请输入密码(6-16位)";else d.value=i.value?"请输入用户名":"请输入用户名(6-12位)"};return(a,e)=>((0,l.uX)(),(0,l.CE)("div",U,[e[11]||(e[11]=(0,l.Fv)('<div class="bg-decoration" data-v-20f06fd1></div><header class="main-header" data-v-20f06fd1><div class="logo" data-v-20f06fd1>茶语智韵</div><nav class="main-nav" data-v-20f06fd1><a href="#" class="nav-link" data-v-20f06fd1>首页</a><a href="#" class="nav-link" data-v-20f06fd1>产品</a><a href="#" class="nav-link" data-v-20f06fd1>解决方案</a><a href="#" class="nav-link" data-v-20f06fd1>支持</a></nav></header>',2)),(0,l.Lk)("div",Y,[e[10]||(e[10]=(0,l.Fv)('<div class="brand-section" data-v-20f06fd1><div class="artistic-description" data-v-20f06fd1><p class="description-line" data-v-20f06fd1>融合智能科技与传统茶文化，</p><p class="description-line" data-v-20f06fd1>打造现代化茶园管理解决方案</p></div><div class="brand-image" data-v-20f06fd1><img src="https://picsum.photos/id/155/600/400" alt="智能茶园管理系统展示图" class="feature-image" data-v-20f06fd1></div></div>',1)),(0,l.Lk)("div",z,[(0,l.Lk)("h2",q,(0,k.v_)(i.value?"用户登录":"用户注册"),1),(0,l.Lk)("form",{onSubmit:(0,s.D$)(u,["prevent"]),class:"auth-form"},[(0,l.Lk)("div",H,[e[5]||(e[5]=(0,l.Lk)("div",{class:"input-icon"},[(0,l.Lk)("i",{class:"icon-user"})],-1)),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>c.value.username=a),placeholder:i.value?"请输入用户名":"请输入用户名(6-12位)",required:"",class:"form-input"},null,8,j),[[s.Jo,c.value.username]])]),(0,l.Lk)("div",N,[e[7]||(e[7]=(0,l.Lk)("div",{class:"input-icon"},[(0,l.Lk)("i",{class:"icon-lock"})],-1)),(0,l.bo)((0,l.Lk)("input",{type:r.value?"text":"password","onUpdate:modelValue":e[1]||(e[1]=a=>c.value.password=a),placeholder:i.value?"请输入密码":"请输入密码(6-16位)",required:"",class:"form-input"},null,8,O),[[s.hp,c.value.password]]),(0,l.Lk)("span",{class:"eye-icon",onClick:e[2]||(e[2]=a=>r.value=!r.value)},e[6]||(e[6]=[(0,l.Lk)("i",{class:"icon-eye"},null,-1)]))]),i.value?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",G,[e[8]||(e[8]=(0,l.Lk)("div",{class:"input-icon"},[(0,l.Lk)("i",{class:"icon-lock"})],-1)),(0,l.bo)((0,l.Lk)("input",{type:"password","onUpdate:modelValue":e[3]||(e[3]=a=>c.value.confirmPassword=a),placeholder:"请确认密码",required:"",class:"form-input"},null,512),[[s.Jo,c.value.confirmPassword]])])),(0,l.Lk)("button",Q,[(0,l.Lk)("span",J,(0,k.v_)(i.value?"登 录":"注 册"),1),e[9]||(e[9]=(0,l.Lk)("span",{class:"btn-arrow"},"→",-1))])],32),(0,l.Lk)("p",{class:"toggle-text",onClick:e[4]||(e[4]=a=>i.value=!i.value)},(0,k.v_)(i.value?"没有账号？点击注册":"已有账号？点击登录"),1),d.value?((0,l.uX)(),(0,l.CE)("p",{key:0,class:(0,k.C4)(["error-message",{show:d.value}])},(0,k.v_)(d.value),3)):(0,l.Q3)("",!0)])]),e[12]||(e[12]=(0,l.Fv)('<footer class="page-footer" data-v-20f06fd1><div class="footer-content" data-v-20f06fd1><div class="footer-links" data-v-20f06fd1><a href="#" class="footer-link" data-v-20f06fd1>关于我们</a><a href="#" class="footer-link" data-v-20f06fd1>隐私政策</a><a href="#" class="footer-link" data-v-20f06fd1>服务条款</a><a href="#" class="footer-link" data-v-20f06fd1>联系我们</a></div><p class="copyright" data-v-20f06fd1>© 2023 茶语智韵 版权所有</p></div></footer>',1))]))}};const aa=(0,u.A)(Z,[["__scopeId","data-v-20f06fd1"]]);var ea=aa,ta=(t(8111),t(2489),t(1701),t(2261));const sa=(0,ta.nY)("garden",{state:()=>({gardenList:[{id:"1001",name:"云雾山茶园",address:"福建省武夷山市星村镇桐木村",latitude:27.76,longitude:117.9,area:80.5,variety:"大红袍",plantingYear:2010,owner:"武夷山岩茶合作社",certification:"有机认证",status:"正常生产"},{id:"1002",name:"阳光茶园一号",address:"云南省西双版纳州勐海县勐混镇",latitude:21.98,longitude:100.54,area:120.3,variety:"普洱",plantingYear:2012,owner:"勐海县茶农专业合作社",certification:"绿色食品",status:"正常生产"},{id:"1003",name:"龙井生态茶园",address:"浙江省杭州市西湖区龙井村",latitude:30.23,longitude:120.76,area:50.8,variety:"龙井",plantingYear:2015,owner:"杭州西湖茶叶有限公司",certification:"有机认证",status:"改造中"}],dialogvisible:!1,currentEditingId:null,isEditMode:!1,tableLoading:!1,formData:{name:"",address:"",latitude:null,longitude:null,area:null,variety:"",plantingYear:null,owner:"",status:""},formRules:{name:[{required:!0,message:"请输入茶园名称",trigger:"blur"},{min:2,max:50,message:"名称长度在 2 到 50 个字符",trigger:"blur"}],address:[{required:!0,message:"请输入详细地址",trigger:"blur"},{min:5,message:"地址至少 5 个字符",trigger:"blur"}],coordinates:[{validator:(a,e,t,s)=>{const{latitude:l,longitude:n}=s;""==l||""==n?t(new Error("请输入完整的经纬度")):l<-90||l>90?t(new Error("纬度值应在 -90 到 90 之间")):n<-180||n>180?t(new Error("经度值应在 -180 到 180 之间")):t()},trigger:"blur"}],area:[{required:!0,message:"请输入茶园面积",trigger:"blur"},{validator:(a,e,t,s)=>{if(e<=0)t(new Error("面积必须大于 0"));else if(e>1e4)t(new Error("面积不能超过 10000 亩"));else if(s.variety&&s.plantingYear){const a=(new Date).getFullYear(),l=a-s.plantingYear,n={"龙井":{min:.5,max:200},"碧螺春":{min:.3,max:150},"大红袍":{min:.2,max:100},"铁观音":{min:.5,max:300},"普洱":{min:1,max:500},default:{min:.1,max:1e4}},o=n[s.variety]||n.default;l<3&&e>.5*o.max?t(new Error(`种植年限较短，建议面积不超过 ${.5*o.max} 亩`)):e<o.min||e>o.max?t(new Error(`${s.variety} 适宜面积范围为 ${o.min} - ${o.max} 亩`)):t()}else t()},trigger:"blur"}],variety:[{required:!0,message:"请选择或输入茶叶品种",trigger:"blur"}],plantingYear:[{required:!0,message:"请输入种植年份",trigger:"blur"},{validator:(a,e,t)=>{const s=(new Date).getFullYear();e<1950?t(new Error("种植年份不能早于 1950 年")):e>s?t(new Error(`种植年份不能晚于 ${s} 年`)):t()},trigger:"blur"}],owner:[{required:!0,message:"请输入所属单位",trigger:"blur"},{min:2,message:"所属单位至少 2 个字符",trigger:"blur"}],status:[{required:!0,message:"请选择生产状态",trigger:"change"}]},statusOption:[{label:"正常生产",value:"正常生产"},{label:"休耕",value:"休耕"},{label:"改造中",value:"改造中"}],teaVarieties:[{label:"龙井",value:"龙井"},{label:"碧螺春",value:"碧螺春"},{label:"大红袍",value:"大红袍"},{label:"铁观音",value:"铁观音"},{label:"普洱",value:"普洱"},{label:"黄山毛峰",value:"黄山毛峰"},{label:"祁门红茶",value:"祁门红茶"}]}),actions:{async verifyLocation(){const{address:a,latitude:e,longitude:t}=this.formData;if(!a||!e||!t)return{success:!1,message:"请填写完整的地址和经纬度信息"};try{const s="c89763ca3b15e5d916703381ed54d338",l=encodeURIComponent(a),n=await fetch(`https://restapi.amap.com/v3/geocode/geo?address=${l}&key=${s}`);if(!n.ok)throw new Error("地址解析服务异常");const o=await n.json();if("1"!==o.status||0===o.geocodes.length)return{success:!1,message:"无法解析该地址，请检查地址是否正确"};const[i,r]=o.geocodes[0].location.split(",").map(Number),d=Math.abs(e-r),c=Math.abs(t-i),u=Math.sqrt(d*d+c*c),v=Math.round(111*u);return u<.01?{success:!0,message:`地址验证通过，经纬度与地址匹配良好（偏差约${v}公里）`}:u<.1?{success:!1,warning:!0,message:`经纬度与地址存在一定偏差（约${v}公里）`,suggestedLat:r,suggestedLng:i}:{success:!1,message:`经纬度与地址偏差较大（约${v}公里）`,suggestedLat:r,suggestedLng:i}}catch(s){return{success:!1,message:`验证失败：${s.message}`}}},openAddForm(){this.resetForm(),this.isEditMode=!1,this.dialogvisible=!0},openEditForm(a){this.resetForm(),this.isEditMode=!0,this.currentEditingId=a.id,this.formData={...a},this.dialogvisible=!0},submitForm(){if(this.isEditMode){const a=this.gardenList.findIndex(a=>a.id===this.currentEditingId);return-1!=a&&(this.gardenList[a]={...this.gardenList[a],...this.formData}),{success:!0,message:"茶园信息更新成功"}}{const a=String(Math.max(...this.gardenList.map(a=>Number(a.id)),0)+1);return this.gardenList.push({id:a,...this.formData}),{success:!0,message:"茶园信息添加成功"}}},resetForm(){this.formData={name:"",address:"",latitude:null,longitude:null,area:null,variety:"",plantingYear:null,owner:"",status:""},this.currentEditingId=null},handleDelete(){return this.gardenList=this.gardenList.filter(a=>a.id!==this.currentEditingId),this.closeDialog(),{success:!0,message:"茶园信息已删除"}},closeDialog(){this.resetForm(),this.dialogvisible=!1},loadData(){this.tableLoading=!0,setTimeout(()=>{this.tableLoading=!1},800)}},getters:{dialogTitle(){return this.isEditMode?"编辑茶园信息":"新增茶园信息"}}});var la={__name:"AddGardenButton",setup(a){const e=sa(),t=()=>{e.openAddForm()};return(a,e)=>{const s=(0,l.g2)("el-button");return(0,l.uX)(),(0,l.Wv)(s,{type:"primary",onClick:t,class:"add"},{default:(0,l.k6)(()=>e[0]||(e[0]=[(0,l.eW)("新增茶园",-1)])),_:1,__:[0]})}}};const na=(0,u.A)(la,[["__scopeId","data-v-1f10a43e"]]);var oa=na,ia=(t(6573),t(8100),t(7936),t(531),t(7588),t(8237),t(3579),t(7642),t(8004),t(3853),t(5876),t(2475),t(5024),t(1698),t(9577),t(1549),t(9797),t(9631),t(5623),t(1219)),ra=t(5320),da=t(7477),ca=t(3230);const ua={class:"import-container"},va={class:"el-upload__tip text-muted"},pa={key:0,class:"file-list"},ma={key:1,class:"duplicate-section"},ha={class:"small-text"},ba={key:0,class:"duplicate-actions"},ka={class:"selected-count"};var ga={__name:"importExcelButton",setup(a){const e=sa(),t=(0,n.KR)(!1),o=(0,n.KR)([]),i=(0,n.KR)(!1),r=(0,n.KR)([]),d=(0,n.KR)(!1),c=(0,n.KR)([]),u=(0,n.KR)(null),v=(0,l.EW)(()=>o.value.reduce((a,e)=>a+e.data.length,0)),p=(0,n.KR)(null),m=a=>o.value.some(e=>e.name===a.name&&e.size===a.size),h=a=>{if(m(a))return void ia.nk.warning(`文件 "${a.name}" 已存在（名称和大小相同），请不要重复上传`);const e=new FileReader;e.onload=e=>{try{const t=new Uint8Array(e.target.result),s=ca.LF(t,{type:"array"}),l=s.SheetNames[0],n=s.Sheets[l],i=ca.Wp.sheet_to_json(n),r=i.map(a=>({name:(a["茶园名称"]||"").trim(),address:(a["详细地址"]||"").trim(),latitude:Number(a["纬度(°N)"])||null,longitude:Number(a["经度(°E)"])||null,area:Number(a["面积(亩)"])||null,variety:a["茶叶品种"]||"",plantingYear:Number(a["种植年份"])||null,owner:a["所属单位"]||"",status:a["生产状态"]||"正常生产"})),d=o.value.findIndex(e=>e.uid===a.uid);d>-1?o.value[d]={...a,data:r}:o.value.push({...a,data:r}),g()}catch{ia.nk.error(`文件${a.name}解析失败，请检查格式`)}},e.readAsArrayBuffer(a.raw)},b=a=>{o.value=o.value.filter(e=>e.uid!==a.uid),g()},g=()=>{const a=o.value.flatMap(a=>a.data),t=a.length;if(r.value=[],d.value=!1,0===t)return;const s=e.gardenList,l=new Set(s.map(a=>a.name.trim())),n=new Set(s.map(a=>a.address.trim())),i=new Map;a.forEach(e=>{const t=`${e.name}-${e.address}`;if(i.has(t))return;const o=s.some(a=>a.name.trim()===e.name.trim()&&a.address.trim()===e.address.trim());if(o)return void i.set(t,{...e,duplicateReason:"与现有茶园信息一致"});const r=a.filter(a=>a.name.trim()===e.name.trim()&&a.address.trim()===e.address.trim()).length;if(r>1)return void i.set(t,{...e,duplicateReason:"与表格中其他茶园信息一致"});const d=[];l.has(e.name)&&d.push("与现有茶园名称一致"),n.has(e.address)&&d.push("与现有茶园地址一致");const c=a.filter(a=>a.name.trim()===e.name.trim()).length,u=a.filter(a=>a.address.trim()===e.address.trim()).length;c>1&&d.push("与表格中其他茶园名称一致"),u>1&&d.push("与表格中其他茶园地址一致"),d.length>0&&d.forEach(a=>{i.set(`${t}-${a}`,{...e,duplicateReason:a})})});const u=Array.from(i.values()),v=u.slice(0,t);r.value=v,d.value=v.length>0,c.value=[]},f=a=>{c.value=a},L=()=>{_.value?c.value=[]:c.value=[...r.value],p.value&&p.value.toggleAllSelection()},_=(0,l.EW)(()=>c.value.length===r.value.length&&r.value.length>0),y=(0,l.EW)(()=>{const a=v.value,e=r.value.length-c.value.length;return a-e}),w=()=>{i.value=!0;const a=ra.Ks.service({lock:!0,text:"正在导入数据...",background:"rgba(0, 0, 0, 0.7)"}),t=o.value.flatMap(a=>a.data),s=new Set(c.value.map(a=>`${a.name}-${a.address}-${a.duplicateReason}`)),l=new Set(r.value.filter(a=>!s.has(`${a.name}-${a.address}-${a.duplicateReason}`)).map(a=>`${a.name}-${a.address}`)),n=t.filter(a=>{const e=r.value.some(e=>e.name===a.name&&e.address===a.address);return!e||!l.has(`${a.name}-${a.address}`)});setTimeout(()=>{try{const t=Math.max(...e.gardenList.map(a=>Number(a.id)),0),s=n.map((a,e)=>({id:String(t+1+e),...a}));e.gardenList.push(...s),a.close(),i.value=!1,ia.nk.success(`成功导入${s.length}条茶园信息`),F()}catch(t){a.close(),i.value=!1,ia.nk.error("导入失败："+t.message)}},1500)},C=()=>{const a=[{"茶园名称":"示例茶园","详细地址":"福建省武夷山市星村镇","纬度(°N)":27.76,"经度(°E)":117.9,"面积(亩)":80.5,"茶叶品种":"大红袍","种植年份":2010,"所属单位":"武夷山岩茶合作社","生产状态":"正常生产"}],e=ca.Wp.json_to_sheet(a),t=ca.Wp.book_new();ca.Wp.book_append_sheet(t,e,"茶园信息模板"),ca._h(t,"茶园信息导入模板.xlsx")},F=()=>{t.value=!1,o.value=[],r.value=[],d.value=!1,c.value=[],u.value&&u.value.clearFiles()};return(a,e)=>{const m=(0,l.g2)("el-icon"),g=(0,l.g2)("el-button"),R=(0,l.g2)("el-upload"),x=(0,l.g2)("el-tag"),D=(0,l.g2)("el-table-column"),E=(0,l.g2)("el-table"),W=(0,l.g2)("el-dialog");return(0,l.uX)(),(0,l.CE)("div",ua,[(0,l.bF)(g,{type:"success",onClick:e[0]||(e[0]=a=>t.value=!0),class:"import-btn"},{default:(0,l.k6)(()=>[(0,l.bF)(m,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,n.R1)(da.Upload))]),_:1}),e[2]||(e[2]=(0,l.eW)(" 批量导入 ",-1))]),_:1,__:[2]}),(0,l.bF)(W,{title:"批量导入茶园信息",modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value=a),width:"700px",onClose:F},{footer:(0,l.k6)(()=>[(0,l.bF)(g,{onClick:F},{default:(0,l.k6)(()=>e[6]||(e[6]=[(0,l.eW)("取消",-1)])),_:1,__:[6]}),(0,l.bF)(g,{type:"primary",onClick:w,loading:i.value,disabled:0===o.value.length||0===y.value},{default:(0,l.k6)(()=>[(0,l.eW)(" 确认导入（导入 "+(0,k.v_)(y.value)+" 条） ",1)]),_:1},8,["loading","disabled"])]),default:(0,l.k6)(()=>[(0,l.bF)(R,{ref_key:"upload",ref:u,class:"upload-excel",action:"#","auto-upload":!1,"on-change":h,"on-remove":b,"show-file-list":!0,multiple:!0,accept:".xlsx, .xls"},{tip:(0,l.k6)(()=>[(0,l.Lk)("div",va,[e[4]||(e[4]=(0,l.eW)(" 支持.xlsx、.xls格式文件，可选择多个文件，",-1)),(0,l.Lk)("a",{href:"#",onClick:(0,s.D$)(C,["prevent"])},"下载模板")])]),default:(0,l.k6)(()=>[(0,l.bF)(g,{type:"primary"},{default:(0,l.k6)(()=>e[3]||(e[3]=[(0,l.eW)("选择Excel文件",-1)])),_:1,__:[3]})]),_:1},512),o.value.length>0?((0,l.uX)(),(0,l.CE)("div",pa,[(0,l.Lk)("h4",null,"已选择 "+(0,k.v_)(o.value.length)+" 个文件（共 "+(0,k.v_)(v.value)+" 条数据）",1),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.value,a=>((0,l.uX)(),(0,l.Wv)(x,{key:a.uid,closable:"","disable-transitions":!1,onClose:e=>b({uid:a.uid})},{default:(0,l.k6)(()=>[(0,l.eW)((0,k.v_)(a.name)+" ("+(0,k.v_)(a.data.length)+"条) ",1)]),_:2},1032,["onClose"]))),128))])):(0,l.Q3)("",!0),d.value?((0,l.uX)(),(0,l.CE)("div",ma,[(0,l.Lk)("h4",null,[e[5]||(e[5]=(0,l.eW)(" 重复数据检测 ",-1)),(0,l.Lk)("span",ha,"( "+(0,k.v_)(r.value.length)+" 条重复数据)",1)]),(0,l.bF)(E,{ref_key:"gardenTableRef",ref:p,data:r.value,border:"",size:"small",style:{width:"100%","margin-top":"10px"},onSelectionChange:f},{default:(0,l.k6)(()=>[(0,l.bF)(D,{type:"selection",width:"55"}),(0,l.bF)(D,{prop:"name",label:"茶园名称",width:"150"}),(0,l.bF)(D,{prop:"address",label:"详细地址",width:"200"}),(0,l.bF)(D,{prop:"duplicateReason",label:"重复原因"})]),_:1},8,["data"]),r.value.length>0?((0,l.uX)(),(0,l.CE)("div",ba,[(0,l.bF)(g,{type:"text",onClick:L,size:"small"},{default:(0,l.k6)(()=>[(0,l.eW)((0,k.v_)(_.value?"取消全选":"一键全选"),1)]),_:1}),(0,l.Lk)("span",ka,"已选择 "+(0,k.v_)(c.value.length)+" 条",1)])):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0)]),_:1},8,["modelValue"])])}}};const fa=(0,u.A)(ga,[["__scopeId","data-v-e3ab0848"]]);var La=fa,_a=t(2933);const ya={class:"gardenform"},wa={class:"coordinates-input"};var Ca={__name:"GardenForm",setup(a){const e=sa(),t=(0,n.KR)(null);(0,l.sV)(()=>{e.loadData()});const s=async()=>{const a=ra.Ks.service({lock:!0,text:"正在验证地址准确性...",background:"rgba(0, 0, 0, 0.7)"});try{const a=await e.verifyLocation();if(!a.success&&a.suggestedLat&&a.suggestedLng){const t=await _a.s.confirm(`${a.message}，是否使用地址解析的经纬度？(经度:${a.suggestedLat},纬度:${a.suggestedLng})`,"地址验证提示",{confirmButtonText:"使用解析值",cancelButtonText:"保留原值",type:a.warning?"warning":"error"});"confirm"===t&&e.$patch(e=>{e.formData.latitude=a.suggestedLat,e.formData.longitude=a.suggestedLng})}else a.success?ia.nk.success(a.message):ia.nk.error(a.message)}catch(t){console.error("验证地址或弹窗交互出错：",t)}finally{a.close()}},o=()=>{_a.s.confirm("删除后相关生产记录将受影响，是否确认删除？","警告",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}).then(()=>{const a=ra.Ks.service({lock:!0,text:"正在删除数据...",background:"rgba(0, 0, 0, 0.7)"});setTimeout(()=>{a.close();const t=e.handleDelete();ia.nk.success(t.message)},1e3)}).catch(()=>{ia.nk.info("已取消删除")})},i=()=>{t.value.validate(a=>{if(!a)return!1;const t=ra.Ks.service({lock:!0,text:"正在保存数据...",background:"rgba(0,0,0,0.7)"});setTimeout(()=>{t.close();const a=e.submitForm();a.success?ia.nk.success(a.message):ia.nk.error("请检查无误后重新保存"),e.closeDialog()},1e3)})},r=(0,n.KR)(1),d=a=>{r.value=a};return(a,c)=>{const u=(0,l.g2)("el-table-column"),v=(0,l.g2)("el-tag"),p=(0,l.g2)("el-button"),m=(0,l.g2)("el-table"),h=(0,l.g2)("el-input"),b=(0,l.g2)("el-form-item"),g=(0,l.g2)("el-option"),f=(0,l.g2)("el-select"),L=(0,l.g2)("el-input-number"),_=(0,l.g2)("Location"),y=(0,l.g2)("el-icon"),w=(0,l.g2)("el-form"),C=(0,l.g2)("Delete"),F=(0,l.g2)("Refresh"),R=(0,l.g2)("Check"),x=(0,l.g2)("el-dialog"),D=(0,l.g2)("el-card"),E=(0,l.g2)("el-pagination");return(0,l.uX)(),(0,l.CE)("div",ya,[(0,l.bF)(D,{title:"茶园信息管理"},{default:(0,l.k6)(()=>[(0,l.bF)(m,{data:(0,n.R1)(e).gardenList.slice(10*(r.value-1),10*r.value),border:"",loading:(0,n.R1)(e).tableLoading,stripe:"",style:{width:"1300px"}},{default:(0,l.k6)(()=>[(0,l.bF)(u,{label:"编号",width:"70"},{default:(0,l.k6)(a=>[(0,l.eW)((0,k.v_)(10*(r.value-1)+a.$index+1),1)]),_:1}),(0,l.bF)(u,{prop:"name",label:"茶园名称",width:"120"}),(0,l.bF)(u,{prop:"address",label:"详细地址",width:"250"}),(0,l.bF)(u,{prop:"status",label:"生产状态",width:"120"},{default:(0,l.k6)(a=>[(0,l.bF)(v,{type:"正常生产"===a.row.status?"success":"休耕"===a.row.status?"info":"warning"},{default:(0,l.k6)(()=>[(0,l.eW)((0,k.v_)(a.row.status),1)]),_:2},1032,["type"])]),_:1}),(0,l.bF)(u,{prop:"latitude",label:"纬度(°N)"}),(0,l.bF)(u,{prop:"longitude",label:"经度(°E)"}),(0,l.bF)(u,{prop:"area",label:"面积(亩)"}),(0,l.bF)(u,{prop:"variety",label:"茶叶品种"}),(0,l.bF)(u,{prop:"plantingYear",label:"种植年份"}),(0,l.bF)(u,{prop:"owner",label:"所属单位",width:"180"}),(0,l.bF)(u,{label:"操作",width:"100"},{default:(0,l.k6)(a=>[(0,l.bF)(p,{size:"small",type:"primary",onClick:t=>(0,n.R1)(e).openEditForm(a.row)},{default:(0,l.k6)(()=>c[10]||(c[10]=[(0,l.eW)(" 编辑 ",-1)])),_:2,__:[10]},1032,["onClick"])]),_:1})]),_:1},8,["data","loading"]),(0,l.bF)(x,{title:(0,n.R1)(e).dialogTitle,modelValue:(0,n.R1)(e).dialogvisible,"onUpdate:modelValue":c[9]||(c[9]=a=>(0,n.R1)(e).dialogvisible=a),width:"600px","before-close":(0,n.R1)(e).closeDialog},{footer:(0,l.k6)(()=>[(0,l.bF)(p,{onClick:(0,n.R1)(e).closeDialog},{default:(0,l.k6)(()=>c[12]||(c[12]=[(0,l.eW)("取消",-1)])),_:1,__:[12]},8,["onClick"]),(0,n.R1)(e).isEditMode?((0,l.uX)(),(0,l.Wv)(p,{key:0,type:"danger",onClick:o},{default:(0,l.k6)(()=>[(0,l.bF)(y,null,{default:(0,l.k6)(()=>[(0,l.bF)(C)]),_:1}),c[13]||(c[13]=(0,l.eW)(" 删除 ",-1))]),_:1,__:[13]})):((0,l.uX)(),(0,l.Wv)(p,{key:1,type:"info",onClick:(0,n.R1)(e).resetForm},{default:(0,l.k6)(()=>[(0,l.bF)(y,null,{default:(0,l.k6)(()=>[(0,l.bF)(F)]),_:1}),c[14]||(c[14]=(0,l.eW)(" 重置 ",-1))]),_:1,__:[14]},8,["onClick"])),(0,l.bF)(p,{type:"primary",onClick:i},{default:(0,l.k6)(()=>[(0,l.bF)(y,null,{default:(0,l.k6)(()=>[(0,l.bF)(R)]),_:1}),c[15]||(c[15]=(0,l.eW)(" 保存 ",-1))]),_:1,__:[15]})]),default:(0,l.k6)(()=>[(0,l.bF)(w,{ref_key:"gardenForm",ref:t,model:(0,n.R1)(e).formData,rules:(0,n.R1)(e).formRules,"label-width":"120px"},{default:(0,l.k6)(()=>[(0,l.bF)(b,{label:"茶园名称",prop:"name"},{default:(0,l.k6)(()=>[(0,l.bF)(h,{modelValue:(0,n.R1)(e).formData.name,"onUpdate:modelValue":c[0]||(c[0]=a=>(0,n.R1)(e).formData.name=a),placeholder:"请输入茶园名称",maxlength:"30"},null,8,["modelValue"])]),_:1}),(0,l.bF)(b,{label:"茶园地址",prop:"address"},{default:(0,l.k6)(()=>[(0,l.bF)(h,{modelValue:(0,n.R1)(e).formData.address,"onUpdate:modelValue":c[1]||(c[1]=a=>(0,n.R1)(e).formData.address=a),placeholder:"请输入详细地址",maxlength:"60"},null,8,["modelValue"])]),_:1}),(0,l.bF)(b,{label:"生产状态",prop:"status"},{default:(0,l.k6)(()=>[(0,l.bF)(f,{modelValue:(0,n.R1)(e).formData.status,"onUpdate:modelValue":c[2]||(c[2]=a=>(0,n.R1)(e).formData.status=a),placeholder:"请选择生产状态"},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,n.R1)(e).statusOption,a=>((0,l.uX)(),(0,l.Wv)(g,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,l.bF)(b,{label:"经纬度",prop:"coordinates"},{default:(0,l.k6)(()=>[(0,l.Lk)("div",wa,[(0,l.bF)(L,{modelValue:(0,n.R1)(e).formData.latitude,"onUpdate:modelValue":c[3]||(c[3]=a=>(0,n.R1)(e).formData.latitude=a),min:-90,max:90,step:1e-6,placeholder:"纬度",style:{width:"48%"},"controls-position":"right"},null,8,["modelValue"]),(0,l.bF)(L,{modelValue:(0,n.R1)(e).formData.longitude,"onUpdate:modelValue":c[4]||(c[4]=a=>(0,n.R1)(e).formData.longitude=a),min:-180,max:180,step:1e-6,placeholder:"经度",style:{width:"48%"},"controls-position":"right"},null,8,["modelValue"])]),(0,l.bF)(p,{type:"primary",size:"small",onClick:s},{default:(0,l.k6)(()=>[(0,l.bF)(y,null,{default:(0,l.k6)(()=>[(0,l.bF)(_)]),_:1}),c[11]||(c[11]=(0,l.eW)(" 验证地址准确性 ",-1))]),_:1,__:[11]})]),_:1}),(0,l.bF)(b,{label:"面积(亩)",prop:"area"},{default:(0,l.k6)(()=>[(0,l.bF)(L,{modelValue:(0,n.R1)(e).formData.area,"onUpdate:modelValue":c[5]||(c[5]=a=>(0,n.R1)(e).formData.area=a),min:.1,max:1e4,step:.1,placeholder:"请输入茶园面积","controls-position":"right"},null,8,["modelValue"])]),_:1}),(0,l.bF)(b,{label:"茶叶品种",prop:"variety"},{default:(0,l.k6)(()=>[(0,l.bF)(f,{modelValue:(0,n.R1)(e).formData.variety,"onUpdate:modelValue":c[6]||(c[6]=a=>(0,n.R1)(e).formData.variety=a),placeholder:"请选择或输入茶叶品种",filterable:"","allow-create":""},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,n.R1)(e).teaVarieties,a=>((0,l.uX)(),(0,l.Wv)(g,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,l.bF)(b,{label:"种植年份",prop:"plantingYear"},{default:(0,l.k6)(()=>[(0,l.bF)(L,{modelValue:(0,n.R1)(e).formData.plantingYear,"onUpdate:modelValue":c[7]||(c[7]=a=>(0,n.R1)(e).formData.plantingYear=a),min:1950,max:(new Date).getFullYear(),placeholder:"请输入种植年份","controls-position":"right"},null,8,["modelValue","max"])]),_:1}),(0,l.bF)(b,{label:"所属单位",prop:"owner"},{default:(0,l.k6)(()=>[(0,l.bF)(h,{modelValue:(0,n.R1)(e).formData.owner,"onUpdate:modelValue":c[8]||(c[8]=a=>(0,n.R1)(e).formData.owner=a),placeholder:"请输入所属公司或农户",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","before-close"])]),_:1}),c[16]||(c[16]=(0,l.Lk)("br",null,null,-1)),(0,l.bF)(E,{layout:"prev, pager, next, jumper, total","page-size":10,"current-page":r.value,total:(0,n.R1)(e).gardenList.length,onCurrentChange:d,locale:a.paginationLocale},null,8,["current-page","total","locale"])])}}};const Fa=(0,u.A)(Ca,[["__scopeId","data-v-5b961141"]]);var Ra=Fa;const xa={class:"manage-view"},Da={class:"button-group"},Ea={class:"form-container"};var Wa={__name:"ManageView",setup(a){return(a,e)=>((0,l.uX)(),(0,l.CE)("div",xa,[(0,l.Lk)("div",Da,[(0,l.bF)(oa),(0,l.bF)(La)]),(0,l.Lk)("div",Ea,[(0,l.bF)(Ra)])]))}};const Ia=(0,u.A)(Wa,[["__scopeId","data-v-081a91fa"]]);var Sa=Ia;const Ta={class:"dashboard-container"},$a={class:"dashboard-header"},Aa={class:"year-selector"},Va={class:"main-content"},Ma={class:"left-panel"},Xa={class:"panel-section"},Ka={class:"tea-metrics"},Pa={class:"metric-item"},Ba={class:"metric-value"},Ua={class:"metric-item"},Ya={class:"metric-value"},za={class:"metric-item"},qa={class:"metric-value"},Ha={class:"panel-section equipment-status"},ja={class:"equipment-grid"},Na={class:"equipment-info"},Oa={class:"equipment-name"},Ga={class:"equipment-metrics"},Qa={class:"total"},Ja={class:"normal"},Za={class:"abnormal"},ae={class:"panel-section"},ee={class:"monitoring-grid"},te={id:"temperature",class:"monitor-value"},se={id:"humidity",class:"monitor-value"},le={id:"soil-moisture",class:"monitor-value"},ne={id:"pest-index",class:"monitor-value"},oe={class:"center-panel"},ie={class:"map-header"},re={class:"map-actions"},de={class:"map-view-controls"},ce={class:"map-container"},ue={class:"map-stats"},ve={class:"stat-item"},pe={class:"stat-value"},me={class:"stat-item"},he={class:"stat-value"},be={class:"stat-item"},ke={class:"stat-value"},ge={id:"town-list",class:"town-list-container"},fe={id:"county-name"},Le={class:"towns-scroll-container"},_e={class:"town-list",id:"towns-container"},ye=["onClick"],we={class:"right-panel"},Ce={class:"panel-section realtime-video"},Fe={class:"video-container"},Re=["src"],xe={class:"video-controls"},De={class:"video-stats"},Ee={class:"stat-item"},We={id:"current-monitor",class:"stat-value"},Ie={class:"stat-item"},Se={id:"update-time",class:"stat-value"},Te={class:"stat-item"},$e={id:"health-index",class:"stat-value"},Ae={class:"bottom-charts"},Ve={class:"chart-section"},Me={class:"chart-actions"},Xe={class:"chart-section"},Ke={class:"chart-actions"};function Pe(a,e,t,n,o,i){return(0,l.uX)(),(0,l.CE)("div",Ta,[(0,l.Lk)("header",$a,[e[12]||(e[12]=(0,l.Lk)("h1",null,"河源智慧茶园大数据平台",-1)),(0,l.Lk)("div",Aa,[e[11]||(e[11]=(0,l.Lk)("label",{for:"year"},"选择年份:",-1)),(0,l.bo)((0,l.Lk)("select",{id:"year","onUpdate:modelValue":e[0]||(e[0]=a=>o.currentYear=a),onChange:e[1]||(e[1]=(...a)=>i.handleYearChange&&i.handleYearChange(...a))},e[10]||(e[10]=[(0,l.Lk)("option",{value:"2025"},"2025",-1),(0,l.Lk)("option",{value:"2024"},"2024",-1),(0,l.Lk)("option",{value:"2023"},"2023",-1),(0,l.Lk)("option",{value:"2022"},"2022",-1)]),544),[[s.u1,o.currentYear]])])]),(0,l.Lk)("main",Va,[(0,l.Lk)("div",Ma,[(0,l.Lk)("div",Xa,[e[19]||(e[19]=(0,l.Lk)("h2",null,"茶园核心指标",-1)),(0,l.Lk)("div",Ka,[(0,l.Lk)("div",Pa,[e[13]||(e[13]=(0,l.Lk)("span",{class:"metric-label"},"茶园总数",-1)),(0,l.Lk)("span",Ba,(0,k.v_)(o.teaMetrics.total),1),e[14]||(e[14]=(0,l.Lk)("span",{class:"metric-unit"},"个",-1))]),(0,l.Lk)("div",Ua,[e[15]||(e[15]=(0,l.Lk)("span",{class:"metric-label"},"覆盖面积",-1)),(0,l.Lk)("span",Ya,(0,k.v_)(o.teaMetrics.area),1),e[16]||(e[16]=(0,l.Lk)("span",{class:"metric-unit"},"亩",-1))]),(0,l.Lk)("div",za,[e[17]||(e[17]=(0,l.Lk)("span",{class:"metric-label"},"茶树总数",-1)),(0,l.Lk)("span",qa,(0,k.v_)(o.teaMetrics.count),1),e[18]||(e[18]=(0,l.Lk)("span",{class:"metric-unit"},"亿株",-1))])])]),(0,l.Lk)("div",Ha,[e[20]||(e[20]=(0,l.Lk)("h2",null,"监测设备状态",-1)),(0,l.Lk)("div",ja,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.equipmentList,(a,e)=>((0,l.uX)(),(0,l.CE)("div",{class:"equipment-item",key:e},[(0,l.Lk)("div",{class:(0,k.C4)(`equipment-icon ${a.iconClass}`)},null,2),(0,l.Lk)("div",Na,[(0,l.Lk)("span",Oa,(0,k.v_)(a.name),1),(0,l.Lk)("div",Ga,[(0,l.Lk)("span",Qa,"总数: "+(0,k.v_)(a.total),1),(0,l.Lk)("span",Ja,"正常: "+(0,k.v_)(a.normal),1),(0,l.Lk)("span",Za,"异常: "+(0,k.v_)(a.abnormal),1)])])]))),128))])]),(0,l.Lk)("div",ae,[e[29]||(e[29]=(0,l.Lk)("h2",null,"实时环境监测",-1)),(0,l.Lk)("div",ee,[(0,l.Lk)("div",{class:(0,k.C4)(["monitor-item",{abnormal:o.sensorData.tempAbnormal}])},[e[21]||(e[21]=(0,l.Lk)("div",{class:"monitor-icon temperature-icon"},null,-1)),e[22]||(e[22]=(0,l.Lk)("span",{class:"monitor-label"},"空气温度",-1)),(0,l.Lk)("span",te,(0,k.v_)(o.sensorData.temperature)+"°C",1)],2),(0,l.Lk)("div",{class:(0,k.C4)(["monitor-item",{abnormal:o.sensorData.humAbnormal}])},[e[23]||(e[23]=(0,l.Lk)("div",{class:"monitor-icon humidity-icon"},null,-1)),e[24]||(e[24]=(0,l.Lk)("span",{class:"monitor-label"},"空气湿度",-1)),(0,l.Lk)("span",se,(0,k.v_)(o.sensorData.humidity)+"%",1)],2),(0,l.Lk)("div",{class:(0,k.C4)(["monitor-item",{abnormal:o.sensorData.moistAbnormal}])},[e[25]||(e[25]=(0,l.Lk)("div",{class:"monitor-icon soil-moisture-icon"},null,-1)),e[26]||(e[26]=(0,l.Lk)("span",{class:"monitor-label"},"土壤湿度",-1)),(0,l.Lk)("span",le,(0,k.v_)(o.sensorData.soil_moisture)+"%",1)],2),(0,l.Lk)("div",{class:(0,k.C4)(["monitor-item",{abnormal:o.sensorData.pestAbnormal}])},[e[27]||(e[27]=(0,l.Lk)("div",{class:"monitor-icon pest-icon"},null,-1)),e[28]||(e[28]=(0,l.Lk)("span",{class:"monitor-label"},"病虫害指数",-1)),(0,l.Lk)("span",ne,(0,k.v_)(o.sensorData.pest_index)+"级",1)],2)])])]),(0,l.Lk)("div",oe,[(0,l.Lk)("div",ie,[(0,l.Lk)("h2",null,(0,k.v_)(o.mapTitle),1),(0,l.Lk)("div",re,[(0,l.bo)((0,l.Lk)("button",{id:"back-to-city",class:"back-btn",onClick:e[2]||(e[2]=(...a)=>i.handleBackToCity&&i.handleBackToCity(...a))},e[30]||(e[30]=[(0,l.Lk)("i",{class:"back-icon"},null,-1),(0,l.eW)("返回全市 ",-1)]),512),[[s.aG,o.showBackBtn]]),(0,l.Lk)("div",de,[(0,l.Lk)("button",{class:(0,k.C4)(["view-btn",{active:"map"===o.currentView}]),onClick:e[3]||(e[3]=a=>i.handleViewChange("map"))}," 地图视图 ",2),(0,l.Lk)("button",{class:(0,k.C4)(["view-btn",{active:"satellite"===o.currentView}]),onClick:e[4]||(e[4]=a=>i.handleViewChange("satellite"))}," 卫星视图 ",2)])])]),(0,l.Lk)("div",ce,[e[37]||(e[37]=(0,l.Lk)("div",{id:"map",style:{width:"100%",height:"100%"}},null,-1)),(0,l.Lk)("div",ue,[(0,l.Lk)("div",ve,[e[31]||(e[31]=(0,l.Lk)("span",{class:"stat-label"},"经营主体",-1)),(0,l.Lk)("span",pe,(0,k.v_)(o.mapStats.business),1),e[32]||(e[32]=(0,l.Lk)("span",{class:"stat-unit"},"个",-1))]),(0,l.Lk)("div",me,[e[33]||(e[33]=(0,l.Lk)("span",{class:"stat-label"},"种植总面积",-1)),(0,l.Lk)("span",he,(0,k.v_)(o.mapStats.area),1),e[34]||(e[34]=(0,l.Lk)("span",{class:"stat-unit"},"亩",-1))]),(0,l.Lk)("div",be,[e[35]||(e[35]=(0,l.Lk)("span",{class:"stat-label"},"种植品种",-1)),(0,l.Lk)("span",ke,(0,k.v_)(o.mapStats.varieties),1),e[36]||(e[36]=(0,l.Lk)("span",{class:"stat-unit"},"种",-1))])])]),(0,l.bo)((0,l.Lk)("div",ge,[(0,l.Lk)("h3",fe,(0,k.v_)(o.countyName)+"乡镇列表",1),(0,l.Lk)("div",Le,[(0,l.Lk)("div",_e,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.townList,a=>((0,l.uX)(),(0,l.CE)("div",{class:(0,k.C4)(["town-item",{selected:o.selectedTown===a}]),key:a,onClick:e=>i.handleTownClick(a)},(0,k.v_)(a),11,ye))),128))])])],512),[[s.aG,o.showTownList]])]),(0,l.Lk)("div",we,[e[43]||(e[43]=(0,l.Fv)('<div class="panel-section farmer-overview" data-v-408e7f9a><h2 data-v-408e7f9a>养殖户概况</h2><div class="farmer-metrics" data-v-408e7f9a><div class="farmer-item" data-v-408e7f9a><span class="farmer-label" data-v-408e7f9a>养殖户总数</span><span class="farmer-value" data-v-408e7f9a>1,256</span><span class="farmer-unit" data-v-408e7f9a>户</span></div><div class="farmer-item" data-v-408e7f9a><span class="farmer-label" data-v-408e7f9a>年均收入</span><span class="farmer-value" data-v-408e7f9a>18.7</span><span class="farmer-unit" data-v-408e7f9a>万元</span></div><div class="farmer-item" data-v-408e7f9a><span class="farmer-label" data-v-408e7f9a>平均种植面积</span><span class="farmer-value" data-v-408e7f9a>69.8</span><span class="farmer-unit" data-v-408e7f9a>亩/户</span></div><div class="farmer-item" data-v-408e7f9a><span class="farmer-label" data-v-408e7f9a>茶叶平均售价</span><span class="farmer-value" data-v-408e7f9a>186</span><span class="farmer-unit" data-v-408e7f9a>元/斤</span></div></div></div><div class="panel-section income-trend" data-v-408e7f9a><h2 data-v-408e7f9a>年龄收入趋势</h2><div class="chart-container" data-v-408e7f9a><canvas id="ageIncomeChart" data-v-408e7f9a></canvas></div></div>',2)),(0,l.Lk)("div",Ce,[e[42]||(e[42]=(0,l.Lk)("h2",null,"实时监测视频流",-1)),(0,l.Lk)("div",Fe,[(0,l.Lk)("img",{id:"drone-video",src:o.droneVideoSrc,alt:"无人机实时视频流"},null,8,Re),(0,l.Lk)("div",xe,[(0,l.bo)((0,l.Lk)("select",{id:"drone-selector","onUpdate:modelValue":e[5]||(e[5]=a=>o.selectedDrone=a),onChange:e[6]||(e[6]=(...a)=>i.handleDroneChange&&i.handleDroneChange(...a)),ref:"droneSelector"},e[38]||(e[38]=[(0,l.Lk)("option",{value:"drone1"},"无人机 #1 (紫城镇)",-1),(0,l.Lk)("option",{value:"drone2"},"无人机 #2 (龙窝镇)",-1),(0,l.Lk)("option",{value:"drone3"},"无人机 #3 (九和镇)",-1),(0,l.Lk)("option",{value:"drone4"},"无人机 #4 (蓝塘镇)",-1)]),544),[[s.u1,o.selectedDrone]]),(0,l.Lk)("button",{class:"refresh-btn",onClick:e[7]||(e[7]=(...a)=>i.handleVideoRefresh&&i.handleVideoRefresh(...a))},"刷新")])]),(0,l.Lk)("div",De,[(0,l.Lk)("div",Ee,[e[39]||(e[39]=(0,l.Lk)("span",{class:"stat-label"},"当前监测点",-1)),(0,l.Lk)("span",We,(0,k.v_)(o.currentMonitorPoint),1)]),(0,l.Lk)("div",Ie,[e[40]||(e[40]=(0,l.Lk)("span",{class:"stat-label"},"最后更新时间",-1)),(0,l.Lk)("span",Se,(0,k.v_)(o.updateTime),1)]),(0,l.Lk)("div",Te,[e[41]||(e[41]=(0,l.Lk)("span",{class:"stat-label"},"健康指数",-1)),(0,l.Lk)("span",$e,(0,k.v_)(o.healthIndex),1)])])])])]),(0,l.Lk)("footer",Ae,[(0,l.Lk)("div",Ve,[e[44]||(e[44]=(0,l.Lk)("h3",null,"近30天生长指标曲线",-1)),e[45]||(e[45]=(0,l.Lk)("div",{class:"chart-container"},[(0,l.Lk)("canvas",{id:"growthTrendChart"})],-1)),(0,l.Lk)("div",Me,[(0,l.Lk)("button",{class:"export-data-btn",onClick:e[8]||(e[8]=a=>i.handleExportData("近30天生长指标曲线"))},"导出数据")])]),(0,l.Lk)("div",Xe,[e[46]||(e[46]=(0,l.Lk)("h3",null,"病虫害发生频次热⼒图",-1)),e[47]||(e[47]=(0,l.Lk)("div",{class:"chart-container"},[(0,l.Lk)("canvas",{id:"pestHeatmapChart"})],-1)),(0,l.Lk)("div",Ke,[(0,l.Lk)("button",{class:"export-data-btn",onClick:e[9]||(e[9]=a=>i.handleExportData("病虫害发生频次热⼒图"))},"导出数据")])])])])}var Be=t(1921),Ue=t(6591),Ye=t(1358);Ue.Ay.register(Ye.m,Ye.k);var ze={data(){return{currentYear:"2025",updateTime:this.formatTime(new Date),healthIndex:"92.5",hasBackend:!1,teaMetrics:{total:"10,336",area:"87,675",count:"1.32"},equipmentList:[{name:"地面传感器",iconClass:"ground-sensor",total:326,normal:318,abnormal:8},{name:"无人机",iconClass:"drone-sensor",total:12,normal:12,abnormal:0},{name:"病虫害监测仪",iconClass:"pest-sensor",total:89,normal:85,abnormal:4}],sensorData:{temperature:"25.6",humidity:"68",soil_moisture:"28.3",pest_index:"0.23",tempAbnormal:!1,humAbnormal:!1,moistAbnormal:!1,pestAbnormal:!1},currentRegion:{level:"city",code:"441600",name:"河源市",town:""},mapTitle:"河源市茶园分布",showBackBtn:!1,currentView:"map",mapStats:{business:"10,336",area:"87,675",varieties:"77"},showTownList:!1,countyName:"",townList:[],selectedTown:"",mapChart:null,selectedDrone:"drone1",droneVideoSrc:"https://picsum.photos/seed/drone/800/450",currentMonitorPoint:"紫金县紫城镇茶园",growthTrendChart:null,pestHeatmapChart:null,ageIncomeChart:null,sensorUpdateInterval:null,sseSource:null}},methods:{formatTime(a){return a.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).replace(/\//g,"-")},handleYearChange(){this.hasBackend?this.fetchHistoricalData(this.currentYear):(this.updatePestHeatmapData(),this.updateGrowthTrendData())},handleBackToCity(){this.currentRegion={level:"city",code:"441600",name:"河源市"},this.mapTitle="河源市茶园分布",this.mapStats={business:"10,336",area:"87,675",varieties:"77"},this.showBackBtn=!1,this.showTownList=!1,this.currentView="map",this.renderCityMap()},handleViewChange(a){this.currentView=a,"satellite"===a&&"town"===this.currentRegion.level&&this.renderTownMap(this.currentRegion.town)},handleTownClick(a){this.selectedTown=a,this.currentRegion={...this.currentRegion,level:"town",town:a},this.mapTitle=`${this.currentRegion.name}${a}茶园`,this.currentMonitorPoint=`${this.currentRegion.name}${a}茶园`,this.hasBackend?this.fetchPlantationDetail(this.currentRegion.code,a):(this.currentView="satellite",this.renderTownMap(a))},handleDroneChange(){const a=this.$refs.droneSelector.options[this.$refs.droneSelector.selectedIndex],e=a.text.match(/\((.*?)\)/)[1];this.currentMonitorPoint=`紫金县${e}茶园`,this.hasBackend?this.fetchDroneImage(a.value):this.droneVideoSrc=`https://picsum.photos/seed/${e}${Date.now()}/800/450`},handleVideoRefresh(){if(this.hasBackend)this.fetchDroneImage(this.selectedDrone);else{const a=this.$refs.droneSelector.options[this.$refs.droneSelector.selectedIndex],e=a.text.match(/\((.*?)\)/)[1];this.droneVideoSrc=`https://picsum.photos/seed/${e}${Date.now()}/800/450`,this.updateTime=this.formatTime(new Date),this.healthIndex=(90+10*Math.random()).toFixed(1)}},handleExportData(a){if(this.hasBackend){const e=a.includes("生长指标")?"growth":"pest";this.exportData(e)}else alert(`正在导出${a}静态数据...`),setTimeout(()=>{alert(`${a}静态数据导出成功！`)},1e3)},initMap(){const a=document.getElementById("map");this.mapChart=Be.Ts(a),this.mapChart.showLoading({text:"地图加载中...",textColor:"#fff",backgroundColor:"rgba(0,0,0,0.7)",spinnerRadius:20}),this.hasBackend?this.fetchPlantationList().then(()=>{this.mapChart.hideLoading()}).catch(a=>{console.error("获取茶园数据失败:",a),this.mapChart.hideLoading(),this.renderCityMap()}):this.loadMapData(this.currentRegion.code).then(a=>{Be.mz("heyuan",a),this.renderCityMap(),this.mapChart.hideLoading()}).catch(a=>{console.error("地图加载失败:",a),this.mapChart.hideLoading(),this.mapChart.setOption({title:{text:"地图加载失败",left:"center",top:"center",textStyle:{color:"#ff4d4f"}}})})},loadMapData(a){return fetch(`https://geo.datav.aliyun.com/areas_v3/bound/${a}_full.json`).then(a=>{if(!a.ok)throw new Error(`HTTP错误: ${a.status}`);return a.json()})},renderCityMap(){const a={tooltip:{trigger:"item",formatter:a=>`\n            <div style="font-size:14px">${a.name}</div>\n            <div>经营主体: ${a.data.business}个</div>\n            <div>种植面积: ${a.data.area}亩</div>\n            <div>茶叶品种: ${a.data.varieties}种</div>\n          `},series:[{name:"茶园数据",type:"map",map:"city"===this.currentRegion.level?"heyuan":"county",roam:!0,label:{show:!0,fontSize:12,color:"#fff"},itemStyle:{areaColor:"#1c5f8b",borderColor:"#00d2ff",borderWidth:1},emphasis:{itemStyle:{areaColor:"#ff7a45"}},data:[{name:"源城区",adcode:"441602",business:1856,area:12500,varieties:15},{name:"紫金县",adcode:"441621",business:2356,area:18750,varieties:22},{name:"龙川县",adcode:"441622",business:2103,area:16800,varieties:18},{name:"连平县",adcode:"441623",business:1520,area:10500,varieties:12},{name:"和平县",adcode:"441624",business:1680,area:13200,varieties:14},{name:"东源县",adcode:"441625",business:1821,area:15925,varieties:16}]}]};this.mapChart.setOption(a),this.mapChart.off("click"),this.mapChart.on("click",a=>{a.data?.adcode&&(this.currentRegion={level:"county",code:a.data.adcode,name:a.name},this.mapTitle=`${this.currentRegion.name}茶园分布`,this.mapStats={business:a.data.business.toLocaleString(),area:a.data.area.toLocaleString(),varieties:a.data.varieties},this.showBackBtn=!0,this.showTownList=!0,this.countyName=a.name,this.townList=this.getTownList(a.data.adcode),this.hasBackend?this.fetchCountyPlantations(a.data.adcode):this.loadMapData(a.data.adcode).then(a=>{Be.mz("county",a),this.renderCountyMap()}))})},renderCountyMap(){const a={towns:this.townList},e=a.towns.map(a=>({name:a,value:Math.floor(500*Math.random())+300,business:Math.floor(100*Math.random())+50,area:Math.floor(2e3*Math.random())+800})),t={tooltip:{trigger:"item",formatter:a=>`\n            <div style="font-size:14px">${a.name}</div>\n            <div>经营主体: ${a.data.business}个</div>\n            <div>种植面积: ${a.data.area}亩</div>\n          `},series:[{name:"乡镇数据",type:"map",map:"county",roam:!0,label:{show:!0,fontSize:12,color:"#fff"},itemStyle:{areaColor:"#1c5f8b",borderColor:"#00d2ff",borderWidth:1},emphasis:{itemStyle:{areaColor:"#ff7a45"}},data:e}]};this.mapChart.setOption(t),this.mapChart.off("click"),this.mapChart.on("click",a=>{a.data&&this.handleTownClick(a.name)})},renderTownMap(a){const e={tooltip:{trigger:"item"},geo:{map:"county",roam:!0,itemStyle:{areaColor:"#1a2a3a",borderColor:"#00d2ff",borderWidth:1}},series:[{name:"茶园分布",type:"scatter",coordinateSystem:"geo",data:[{name:"茶园A区",value:[114.7,23.7,15],itemStyle:{color:"#00ff9d"}},{name:"茶园B区",value:[114.75,23.72,20],itemStyle:{color:"#00d2ff"}},{name:"茶园C区",value:[114.68,23.68,18],itemStyle:{color:"#ff7a45"}}],symbolSize:a=>a[2]||10,label:{formatter:"{b}",position:"right",show:!0,color:"#fff"}}]};this.mapChart.setOption(e)},getTownList(a){const e={441602:["上城街道","东埔街道","新江街道","源西街道","高埔岗街道"],441621:["紫城镇","龙窝镇","九和镇","蓝塘镇","古竹镇"],441622:["老隆镇","佗城镇","鹤市镇","铁场镇","龙母镇"],441623:["元善镇","忠信镇","大湖镇","三角镇","上坪镇"],441624:["阳明镇","彭寨镇","东水镇","林寨镇","热水镇"],441625:["仙塘镇","灯塔镇","骆湖镇","船塘镇","顺天镇"]};return e[a]||[]},initCharts(){this.initAgeIncomeChart(),this.initGrowthTrendChart(),this.initPestHeatmapChart()},initAgeIncomeChart(){const a=document.getElementById("ageIncomeChart").getContext("2d");this.ageIncomeChart=new Ue.Ay(a,{type:"bar",data:{labels:["20-30岁","30-40岁","40-50岁","50-60岁","60岁以上"],datasets:[{label:"养殖户数量",data:[120,350,450,380,220],backgroundColor:"rgba(0, 210, 255, 0.7)",borderColor:"rgba(0, 210, 255, 1)",borderWidth:1,yAxisID:"y"},{label:"年均收入(万元)",data:[12.5,18.3,22.8,19.5,15.2],backgroundColor:"rgba(255, 122, 69, 0.7)",borderColor:"rgba(255, 122, 69, 1)",borderWidth:1,yAxisID:"y1"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:"rgba(255, 255, 255, 0.7)",boxWidth:12,font:{size:11}}}},scales:{y:{type:"linear",position:"left",beginAtZero:!0,grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{color:"rgba(255, 255, 255, 0.7)"}},y1:{type:"linear",position:"right",beginAtZero:!0,grid:{drawOnChartArea:!1},ticks:{color:"rgba(255, 255, 255, 0.7)"}},x:{grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{color:"rgba(255, 255, 255, 0.7)"}}}}})},initGrowthTrendChart(){const a=document.getElementById("growthTrendChart").getContext("2d"),e=[],t=new Date;for(let s=29;s>=0;s--){const a=new Date(t);a.setDate(t.getDate()-s),e.push(`${a.getMonth()+1}/${a.getDate()}`)}this.growthTrendChart=new Ue.Ay(a,{type:"line",data:{labels:e,datasets:[{label:"温度",data:this.generateTrendData(20,30,30),borderColor:"#00d2ff",backgroundColor:"rgba(0, 210, 255, 0.1)",tension:.4,fill:!0,yAxisID:"y"},{label:"湿度",data:this.generateTrendData(50,80,30),borderColor:"#00ff9d",backgroundColor:"rgba(0, 255, 157, 0.1)",tension:.4,fill:!0,yAxisID:"y1"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:"rgba(255, 255, 255, 0.7)",boxWidth:12,font:{size:11}}}},scales:{y:{type:"linear",position:"left",min:15,max:35,grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{color:"rgba(255, 255, 255, 0.7)",callback:a=>`${a}°C`}},y1:{type:"linear",position:"right",min:40,max:90,grid:{drawOnChartArea:!1},ticks:{color:"rgba(255, 255, 255, 0.7)",callback:a=>`${a}%`}},x:{grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{color:"rgba(255, 255, 255, 0.7)",maxTicksLimit:10}}}}})},initPestHeatmapChart(){const a=document.getElementById("pestHeatmapChart").getContext("2d"),e=this.generatePestHeatmapData(),t=["rgba(0, 210, 255, 0.1)","rgba(0, 210, 255, 0.3)","rgba(0, 210, 255, 0.5)","rgba(255, 122, 69, 0.5)","rgba(255, 77, 79, 0.7)"];this.pestHeatmapChart=new Ue.Ay(a,{type:"matrix",data:{datasets:[{label:"病虫害发生频次",data:e,backgroundColor:a=>{const e=a.dataset.data[a.dataIndex].v,s=Math.min(Math.floor(e/20),t.length-1);return t[s]},borderColor:"#1a2a3a",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{color:"rgba(255, 255, 255, 0.7)",generateLabels:a=>t.map((a,e)=>({text:`${20*e}-${20*(e+1)}`,fillStyle:a,strokeStyle:"#1a2a3a",lineWidth:1,hidden:!1,index:e}))}},tooltip:{callbacks:{title:()=>"",label:a=>{const e=a.dataset.data[a.dataIndex];return`${e.y} ${e.x}: ${e.v}次`}}}},scales:{x:{type:"category",position:"bottom",grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{color:"rgba(255, 255, 255, 0.7)"}},y:{type:"category",position:"left",grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{color:"rgba(255, 255, 255, 0.7)"}}}}})},generateTrendData(a,e,t){const s=[];let l=a+Math.random()*(e-a);for(let n=0;n<t;n++)l+=(Math.random()-.5)*(e-a)*.1,l=Math.max(a,Math.min(e,l)),s.push(parseFloat(l.toFixed(1)));return s},generatePestHeatmapData(){const a=["源城区","紫金县","龙川县","连平县","和平县","东源县"],e=["茶小绿叶蝉","茶尺蠖","茶蚜","茶炭疽病","茶云纹叶枯病"];return a.flatMap(a=>e.map(e=>({x:e,y:a,v:Math.floor(100*Math.random())})))},initSensorUpdates(){this.hasBackend?this.setupSSE():(this.updateSensorData(),this.sensorUpdateInterval=setInterval(()=>this.updateSensorData(),3e5))},setupSSE(){this.sseSource&&this.sseSource.close(),this.sseSource=new EventSource(`/weather/realtime/${this.currentRegion.code}`),this.sseSource.onmessage=a=>{try{const e=JSON.parse(a.data);200===e.code&&(this.sensorData={...this.sensorData,temperature:e.data.temperature.value.toFixed(1),humidity:e.data.humidity.value.toFixed(0),soil_moisture:e.data.soil_moisture?.value.toFixed(1)||this.sensorData.soil_moisture,pest_index:e.data.pest_index?.value.toFixed(2)||this.sensorData.pest_index,tempAbnormal:e.data.temperature.value<15||e.data.temperature.value>32,humAbnormal:e.data.humidity.value<40||e.data.humidity.value>85,moistAbnormal:e.data.soil_moisture?.value<20||e.data.soil_moisture?.value>35,pestAbnormal:e.data.pest_index?.value>.3},this.updateTime=this.formatTime(new Date))}catch(e){console.error("解析SSE数据失败:",e)}},this.sseSource.onerror=a=>{console.error("SSE连接错误:",a),setTimeout(()=>this.setupSSE(),5e3)}},updateSensorData(){const a=(24+5*Math.random()).toFixed(1),e=Math.floor(55+20*Math.random()),t=(25+10*Math.random()).toFixed(1),s=(.2+.3*Math.random()).toFixed(2);this.sensorData={...this.sensorData,temperature:a,humidity:e,soil_moisture:t,pest_index:s,tempAbnormal:a<15||a>32,humAbnormal:e<40||e>85,moistAbnormal:t<20||t>35,pestAbnormal:s>.3}},updatePestHeatmapData(){const a=this.generatePestHeatmapData();this.pestHeatmapChart.data.datasets[0].data=a,this.pestHeatmapChart.update()},updateGrowthTrendData(){this.growthTrendChart.data.datasets[0].data=this.generateTrendData(20,30,30),this.growthTrendChart.data.datasets[1].data=this.generateTrendData(50,80,30),this.growthTrendChart.update()},fetchPlantationList(){return fetch("/plantations/info",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(a=>{if(!a.ok)throw new Error(`HTTP错误: ${a.status}`);return a.json()}).then(a=>{if(200===a.code)return this.teaMetrics={total:a.data.total.toLocaleString(),area:a.data.area.toLocaleString(),count:a.data.count.toFixed(2)},!0;throw new Error(`接口错误: ${a.message}`)})},fetchPlantationDetail(a,e){return fetch(`/plantations/info/${a}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(a=>{if(!a.ok)throw new Error(`HTTP错误: ${a.status}`);return a.json()}).then(a=>{if(200===a.code)return this.currentView="satellite",this.renderTownMap(e),!0;throw new Error(`接口错误: ${a.message}`)})},fetchDroneImage(a){return fetch(`/drone-images/teaplanation/picture/single/${a}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(a=>{if(!a.ok)throw new Error(`HTTP错误: ${a.status}`);return a.json()}).then(a=>{if(200===a.code&&a.data.drone_images.length>0)return this.droneVideoSrc=a.data.drone_images[0].url,this.updateTime=this.formatTime(new Date),this.healthIndex=(90+10*Math.random()).toFixed(1),!0;throw new Error(`接口错误: ${a.message}`)})},fetchHistoricalData(a){return fetch(`/weather/history/${this.currentRegion.code}?startTime=${a}-01-01&endTime=${a}-12-31`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(a=>{if(!a.ok)throw new Error(`HTTP错误: ${a.status}`);return a.json()}).then(a=>{if(200===a.code)return this.updateChartsWithHistoricalData(a.data),!0;throw new Error(`接口错误: ${a.message}`)})},exportData(a){const e="growth"===a?`/yield-prediction/report/${this.currentRegion.code}`:`/pests/history/export/${this.currentRegion.code}`;fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({format:"pdf",include_visualizations:!0})}).then(a=>{if(!a.ok)throw new Error(`HTTP错误: ${a.status}`);return a.json()}).then(a=>{if(200!==a.code)throw new Error(`接口错误: ${a.message}`);window.open(a.data.downloadUrl,"_blank")}).catch(a=>{console.error("导出数据失败:",a),alert("导出数据失败，请稍后重试")})},updateChartsWithHistoricalData(a){console.log("更新图表数据:",a)},checkBackendAvailability(){fetch("/user/health",{method:"GET"}).then(a=>{this.hasBackend=a.ok}).catch(()=>{this.hasBackend=!1})}},mounted(){this.checkBackendAvailability(),this.initMap(),this.initCharts(),this.initSensorUpdates(),window.addEventListener("resize",()=>{this.mapChart?.resize(),this.growthTrendChart?.resize(),this.pestHeatmapChart?.resize(),this.ageIncomeChart?.resize()})},beforeUnmount(){clearInterval(this.sensorUpdateInterval),this.sseSource&&this.sseSource.close(),this.mapChart?.dispose(),this.growthTrendChart?.destroy(),this.pestHeatmapChart?.destroy(),this.ageIncomeChart?.destroy()}};const qe=(0,u.A)(ze,[["render",Pe],["__scopeId","data-v-408e7f9a"]]);var He=qe;const je={class:"dashboard-view"};var Ne={__name:"DashboardView",setup(a){return(a,e)=>((0,l.uX)(),(0,l.CE)("div",je,[(0,l.bF)(He)]))}};const Oe=(0,u.A)(Ne,[["__scopeId","data-v-8326138a"]]);var Ge=Oe,Qe=t(6018),Je=t(9210),Ze=t(47),at=t(883),et=t(4757),tt=t(4373);const st={class:"history-monitor-container"},lt={class:"query-form"},nt={class:"manual-time-range"},ot={key:1,class:"data-display"},it={key:0,class:"empty-state"},rt="http://your-backend-api-base-url";var dt={__name:"HistoryMonitor",setup(a){const e=(0,n.KR)(""),t=(0,n.KR)(""),o=(0,n.KR)(""),i=(0,n.KR)(""),r=(0,n.KR)(""),d=(0,n.KR)([]),c=(0,n.KR)([]),u=(0,n.KR)(!1),v=(0,n.KR)(!1),p=(0,n.KR)(!1),m=(0,n.KR)(!1),h=(0,n.KR)(!1),b=(0,n.KR)(!1),g=(0,n.KR)(!1),f=async()=>{try{const a=await tt.A.get(`${rt}/api/plantations`);c.value=a.data}catch(a){ia.nk.error("获取茶园列表失败")}};(0,l.sV)(()=>{f()});const L=()=>{r.value="",d.value=[],_()},_=()=>{p.value=!1,m.value=!1,h.value=!1,b.value=!1,g.value=!1},y=async()=>{if(!w())return;if(!F())return;u.value=!0,v.value=!0;const a={plantationId:e.value,startTime:t.value,endTime:o.value,dataType:i.value,sensorType:r.value};try{const e=await tt.A.post(`${rt}/api/teaGarden/query`,a);200===e.data.code?"weather"===i.value?d.value=e.data.data.historical_weather:d.value=e.data.data.historical_soil_data:ia.nk.warning("查询失败，后端返回错误")}catch(s){ia.nk.error("网络异常或接口错误，请稍后重试"),console.error("请求失败:",s)}finally{u.value=!1}},w=()=>{const a=C(t.value,"start"),e=C(o.value,"end");return a&&e},C=(a,e)=>a?!!/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/.test(a)||(ia.nk.warning(("start"===e?"开始时间":"结束时间")+"格式错误，请输入 YYYY-MM-DD HH:mm:ss 格式"),!1):(ia.nk.warning("请填写完整的时间信息"),!1),F=()=>e.value?i.value?!("soil"===i.value&&!r.value)||(ia.nk.warning("选择土壤数据类型时，请指定传感器类型"),!1):(ia.nk.warning("请选择查询的数据类型"),!1):(ia.nk.warning("请选择要查询的茶园"),!1),R=()=>{e.value="",t.value="",o.value="",i.value="",r.value="",d.value=[],v.value=!1,_()},x=(0,l.EW)(()=>({moisture:"土壤湿度",temperature:"土壤温度",ph:"土壤酸碱度",nutrient:"土壤养分(N/P/K)",ec:"土壤电导率"}[r.value]||"测量值"));return(a,f)=>((0,l.uX)(),(0,l.CE)("div",st,[f[10]||(f[10]=(0,l.Lk)("div",{class:"page-title"},"茶园历史监测数据查询",-1)),(0,l.Lk)("div",lt,[(0,l.bF)((0,n.R1)(Qe.AV),{modelValue:e.value,"onUpdate:modelValue":f[0]||(f[0]=a=>e.value=a),placeholder:"请选择茶园",clearable:"",class:"query-item",onChange:a.fetchData},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(c.value,a=>((0,l.uX)(),(0,l.Wv)((0,n.R1)(Qe.P9),{key:a.plantation_id,label:a.plantation_name,value:a.plantation_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),(0,l.Lk)("div",nt,[(0,l.bF)((0,n.R1)(Je.MG),{modelValue:t.value,"onUpdate:modelValue":f[1]||(f[1]=a=>t.value=a),type:"datetime",placeholder:"开始时间",class:"time-input",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"]),f[5]||(f[5]=(0,l.Lk)("span",{class:"range-separator"},"至",-1)),(0,l.bF)((0,n.R1)(Je.MG),{modelValue:o.value,"onUpdate:modelValue":f[2]||(f[2]=a=>o.value=a),type:"datetime",placeholder:"结束时间",class:"time-input",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),(0,l.bF)((0,n.R1)(Qe.AV),{modelValue:i.value,"onUpdate:modelValue":f[3]||(f[3]=a=>i.value=a),placeholder:"请选择数据类型",clearable:"",class:"query-item",onChange:L},{default:(0,l.k6)(()=>[(0,l.bF)((0,n.R1)(Qe.P9),{label:"气象数据",value:"weather"}),(0,l.bF)((0,n.R1)(Qe.P9),{label:"土壤数据",value:"soil"})]),_:1},8,["modelValue"]),"soil"===i.value?((0,l.uX)(),(0,l.Wv)((0,n.R1)(Qe.AV),{key:0,modelValue:r.value,"onUpdate:modelValue":f[4]||(f[4]=a=>r.value=a),placeholder:"请选择传感器类型",clearable:"",class:"query-item"},{default:(0,l.k6)(()=>[(0,l.bF)((0,n.R1)(Qe.P9),{label:"水分传感器",value:"moisture"}),(0,l.bF)((0,n.R1)(Qe.P9),{label:"温度传感器",value:"temperature"}),(0,l.bF)((0,n.R1)(Qe.P9),{label:"pH 传感器",value:"ph"}),(0,l.bF)((0,n.R1)(Qe.P9),{label:"养分传感器",value:"nutrient"}),(0,l.bF)((0,n.R1)(Qe.P9),{label:"电导率传感器",value:"ec"})]),_:1},8,["modelValue"])):(0,l.Q3)("",!0),(0,l.bF)((0,n.R1)(Ze.S2),{type:"primary",onClick:y,class:"query-btn"},{default:(0,l.k6)(()=>f[6]||(f[6]=[(0,l.Lk)("i",{class:"el-icon-search"},null,-1),(0,l.eW)(" 查询 ",-1)])),_:1,__:[6]}),(0,l.bF)((0,n.R1)(Ze.S2),{onClick:R,class:"reset-btn"},{default:(0,l.k6)(()=>f[7]||(f[7]=[(0,l.Lk)("i",{class:"el-icon-refresh"},null,-1),(0,l.eW)(" 重置 ",-1)])),_:1,__:[7]})]),u.value?((0,l.uX)(),(0,l.Wv)((0,n.R1)(ra.Ks),{key:0,text:"正在查询数据，请稍候...",background:"rgba(255, 255, 255, 0.7)"})):(0,l.Q3)("",!0),u.value?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",ot,[0===d.value.length&&v.value?((0,l.uX)(),(0,l.CE)("div",it,[(0,l.bF)((0,n.R1)(at.x0),{description:"暂无符合条件的数据"})])):(0,l.Q3)("",!0),"weather"===i.value?((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[d.value.length>0?((0,l.uX)(),(0,l.Wv)((0,n.R1)(et.Up),{key:0,data:d.value,border:"",stripe:"","header-cell-style":{background:"#f5f7fa"},class:"weather-table"},{default:(0,l.k6)(()=>[(0,l.bF)((0,n.R1)(et.o8),{prop:"timestamp",label:"数据采集时间",width:"220"}),(0,l.bF)((0,n.R1)(et.o8),{label:"温度"},{default:(0,l.k6)(a=>[(0,l.eW)((0,k.v_)(a.row.temperature.value)+" "+(0,k.v_)(a.row.temperature.unit),1)]),_:1}),(0,l.bF)((0,n.R1)(et.o8),{label:"相对湿度"},{default:(0,l.k6)(a=>[(0,l.eW)((0,k.v_)(a.row.humidity.value)+" "+(0,k.v_)(a.row.humidity.unit),1)]),_:1}),(0,l.bF)((0,n.R1)(et.o8),{label:"光照强度"},{default:(0,l.k6)(a=>[(0,l.eW)((0,k.v_)(a.row.light.value)+" "+(0,k.v_)(a.row.light.unit),1)]),_:1}),(0,l.bF)((0,n.R1)(et.o8),{label:"风速"},{default:(0,l.k6)(a=>[(0,l.eW)((0,k.v_)(a.row.wind.speed.value)+" "+(0,k.v_)(a.row.wind.speed.unit),1)]),_:1}),(0,l.bF)((0,n.R1)(et.o8),{label:"风向"},{default:(0,l.k6)(a=>[(0,l.eW)((0,k.v_)(a.row.wind.direction.value)+" "+(0,k.v_)(a.row.wind.direction.unit)+"（"+(0,k.v_)(a.row.wind.direction.description)+"） ",1)]),_:1}),(0,l.bF)((0,n.R1)(et.o8),{label:"降雨量"},{default:(0,l.k6)(a=>[(0,l.eW)((0,k.v_)(a.row.rainfall.value)+" "+(0,k.v_)(a.row.rainfall.unit)+"（"+(0,k.v_)(a.row.rainfall.duration)+"） ",1)]),_:1}),(0,l.bF)((0,n.R1)(et.o8),{label:"设备ID",prop:"device.id"}),(0,l.bF)((0,n.R1)(et.o8),{label:"设备类型",prop:"device.type"}),(0,l.bF)((0,n.R1)(et.o8),{label:"设备位置",prop:"device.location.name"}),(0,l.bF)((0,n.R1)(et.o8),{label:"设备状态",prop:"device.status"}),(0,l.bF)((0,n.R1)(et.o8),{label:"最后校准时间",prop:"device.last_calibration"})]),_:1},8,["data"])):(0,l.Q3)("",!0)],64)):"soil"===i.value?((0,l.uX)(),(0,l.Wv)((0,n.R1)(et.Up),{key:2,data:d.value,border:"",stripe:"","header-cell-style":{background:"#f5f7fa"},class:"soil-table"},{default:(0,l.k6)(()=>[(0,l.bF)((0,n.R1)(et.o8),{prop:"timestamp",label:"数据采集时间",width:"220"}),(0,l.bF)((0,n.R1)(et.o8),{label:x.value,prop:"value"},null,8,["label"]),(0,l.bF)((0,n.R1)(et.o8),{prop:"unit",label:"单位"}),(0,l.bF)((0,n.R1)(et.o8),{prop:"sensor_id",label:"传感器 ID"}),(0,l.bo)((0,l.bF)((0,n.R1)(et.o8),{prop:"soil_moisture.value",label:"土壤湿度"},null,512),[[s.aG,p.value]]),(0,l.bo)((0,l.bF)((0,n.R1)(et.o8),{prop:"soil_temperature.value",label:"土壤温度"},null,512),[[s.aG,m.value]]),(0,l.bo)((0,l.bF)((0,n.R1)(et.o8),{prop:"soil_ph.value",label:"土壤酸碱度"},null,512),[[s.aG,h.value]]),(0,l.bo)((0,l.bF)((0,n.R1)(et.o8),{label:"土壤养分(N/P/K)"},{default:(0,l.k6)(a=>[(0,l.eW)(" N: "+(0,k.v_)(a.row.soil_nutrients.nitrogen.value),1),f[8]||(f[8]=(0,l.Lk)("br",null,null,-1)),(0,l.eW)(" P: "+(0,k.v_)(a.row.soil_nutrients.phosphorus.value),1),f[9]||(f[9]=(0,l.Lk)("br",null,null,-1)),(0,l.eW)(" K: "+(0,k.v_)(a.row.soil_nutrients.potassium.value),1)]),_:1},512),[[s.aG,b.value]]),(0,l.bo)((0,l.bF)((0,n.R1)(et.o8),{prop:"soil_electrical_conductivity.value",label:"土壤电导率"},null,512),[[s.aG,g.value]])]),_:1},8,["data"])):(0,l.Q3)("",!0)]))]))}};const ct=(0,u.A)(dt,[["__scopeId","data-v-278244f1"]]);var ut=ct;const vt={class:"monitor-view"};var pt={__name:"MonitorView",setup(a){return(a,e)=>((0,l.uX)(),(0,l.CE)("div",vt,[e[0]||(e[0]=(0,l.Lk)("h2",null,"历史监控数据",-1)),(0,l.bF)(ut)]))}};const mt=(0,u.A)(pt,[["__scopeId","data-v-7f6869f0"]]);var ht=mt;const bt={class:"profile-container"},kt={key:0,class:"skeleton-container"},gt={class:"skeleton-hero"},ft={class:"skeleton-hero-content"},Lt={class:"skeleton-hero-text"},_t={class:"skeleton-stats"},yt={class:"skeleton-main"},wt={class:"skeleton-sidebar"},Ct={class:"skeleton-profile-card"},Ft={class:"skeleton-info-list"},Rt={class:"skeleton-content"},xt={class:"skeleton-stats-grid"},Dt={class:"skeleton-plantations-grid"},Et={key:1,class:"profile-content"},Wt={class:"hero-section"},It={class:"hero-content"},St={class:"hero-avatar"},Tt=["src"],$t={class:"avatar-upload-btn"},At={class:"hero-info"},Vt={class:"hero-name"},Mt={class:"hero-title"},Xt={class:"hero-subtitle"},Kt={class:"role-switcher"},Pt=["value"],Bt={class:"hero-stats"},Ut={class:"stat-item"},Yt={class:"stat-number"},zt={class:"stat-item"},qt={class:"stat-number"},Ht={class:"stat-item"},jt={class:"stat-number"},Nt={class:"main-layout"},Ot={class:"sidebar"},Gt={class:"profile-card"},Qt={class:"card-header"},Jt={class:"last-update"},Zt={class:"profile-info"},as={class:"info-row"},es={class:"info-value"},ts={class:"info-row"},ss={class:"info-value"},ls={class:"info-row"},ns={class:"info-value"},os={class:"auth-type"},is={key:0,class:"info-row"},rs={class:"info-value"},ds={key:1,class:"info-row"},cs={class:"info-value expire-warning"},us={class:"info-row"},vs={class:"info-value"},ps={class:"profile-card security-card"},ms={class:"device-list"},hs={class:"device-info"},bs=["onClick"],ks={class:"main-content"},gs={class:"stats-section"},fs={class:"stats-grid"},Ls={class:"stat-card"},_s={class:"stat-content"},ys={class:"stat-number"},ws={class:"stat-card"},Cs={class:"stat-content"},Fs={class:"stat-number"},Rs={class:"stat-card"},xs={class:"stat-content"},Ds={class:"stat-number"},Es={class:"stat-card"},Ws={class:"stat-content"},Is={class:"stat-number"},Ss={class:"chart-section"},Ts={class:"chart-container"},$s={ref:"growthChart",width:"800",height:"200"},As={class:"plantations-section"},Vs={class:"plantations-grid"},Ms={class:"card-image"},Xs=["src"],Ks={class:"status-overlay"},Ps={class:"card-content"},Bs={class:"plantation-name"},Us={class:"plantation-location"},Ys={class:"plantation-metrics"},zs={class:"metric"},qs={class:"metric-value"},Hs={class:"metric"},js={class:"metric-value"},Ns={class:"metric"},Os={class:"metric-value"},Gs={class:"pest-status"},Qs={class:"devices-section"},Js={class:"section-header"},Zs={class:"header-actions"},al={class:"plantation-device-groups"},el={class:"group-title"},tl={class:"devices-grid"},sl={class:"device-type"},ll={class:"device-name"},nl={class:"device-firmware"},ol={key:0,class:"upgrade-btn"},il={key:0,class:"empty-state"},rl={class:"inventory-section"},dl={class:"inventory-table"};function cl(a,e,t,n,o,i){return(0,l.uX)(),(0,l.CE)("div",bt,[n.loading?((0,l.uX)(),(0,l.CE)("div",kt,[(0,l.Lk)("div",gt,[e[9]||(e[9]=(0,l.Lk)("div",{class:"skeleton-hero-bg"},null,-1)),(0,l.Lk)("div",ft,[e[8]||(e[8]=(0,l.Lk)("div",{class:"skeleton-avatar-large"},null,-1)),(0,l.Lk)("div",Lt,[e[6]||(e[6]=(0,l.Lk)("div",{class:"skeleton-name"},null,-1)),e[7]||(e[7]=(0,l.Lk)("div",{class:"skeleton-title"},null,-1)),(0,l.Lk)("div",_t,[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(3,a=>(0,l.Lk)("div",{key:a,class:"skeleton-stat"})),64))])])])]),(0,l.Lk)("div",yt,[(0,l.Lk)("div",wt,[(0,l.Lk)("div",Ct,[e[10]||(e[10]=(0,l.Lk)("div",{class:"skeleton-card-header"},null,-1)),(0,l.Lk)("div",Ft,[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(4,a=>(0,l.Lk)("div",{key:a,class:"skeleton-info-row"})),64))])])]),(0,l.Lk)("div",Rt,[(0,l.Lk)("div",xt,[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(4,a=>(0,l.Lk)("div",{key:a,class:"skeleton-stat-card"})),64))]),(0,l.Lk)("div",Dt,[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(6,a=>(0,l.Lk)("div",{key:a,class:"skeleton-plantation-card"})),64))])])])])):((0,l.uX)(),(0,l.CE)("div",Et,[(0,l.Lk)("section",Wt,[e[16]||(e[16]=(0,l.Lk)("div",{class:"hero-background"},"...",-1)),(0,l.Lk)("div",It,[(0,l.Lk)("div",St,[(0,l.Lk)("img",{src:n.userInfo.avatar||n.defaultAvatar,alt:"用户头像",class:"user-avatar-large",onError:e[0]||(e[0]=(...a)=>n.handleAvatarError&&n.handleAvatarError(...a))},null,40,Tt),(0,l.Lk)("div",{class:(0,k.C4)(["avatar-status",n.userInfo.onlineStatus])},null,2),(0,l.Lk)("label",$t,[(0,l.Lk)("input",{type:"file",accept:"image/*",class:"avatar-upload-input",onChange:e[1]||(e[1]=(...a)=>n.handleAvatarSelect&&n.handleAvatarSelect(...a))},null,32),e[11]||(e[11]=(0,l.Lk)("span",{class:"upload-icon"},"📷",-1))])]),(0,l.Lk)("div",At,[(0,l.Lk)("h1",Vt,(0,k.v_)(n.userInfo.nickname),1),(0,l.Lk)("p",Mt,(0,k.v_)(n.roleMap[n.userInfo.currentRole]),1),(0,l.Lk)("p",Xt,"@"+(0,k.v_)(n.userInfo.username),1),(0,l.Lk)("div",Kt,[(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>n.userInfo.currentRole=a),onChange:e[3]||(e[3]=(...a)=>n.handleRoleChange&&n.handleRoleChange(...a))},[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.userInfo.roles,a=>((0,l.uX)(),(0,l.CE)("option",{key:a.code,value:a.code},(0,k.v_)(a.name),9,Pt))),128))],544),[[s.u1,n.userInfo.currentRole]])]),(0,l.Lk)("div",Bt,[(0,l.Lk)("div",Ut,[(0,l.Lk)("span",Yt,(0,k.v_)(n.userInfo.plantations.length),1),e[12]||(e[12]=(0,l.Lk)("span",{class:"stat-label"},"种植园",-1))]),(0,l.Lk)("div",zt,[(0,l.Lk)("span",qt,(0,k.v_)(n.totalDrones),1),e[13]||(e[13]=(0,l.Lk)("span",{class:"stat-label"},"无人机",-1))]),(0,l.Lk)("div",Ht,[(0,l.Lk)("span",jt,(0,k.v_)(n.totalSensors),1),e[14]||(e[14]=(0,l.Lk)("span",{class:"stat-label"},"传感器",-1))])])]),e[15]||(e[15]=(0,l.Lk)("div",{class:"hero-actions"},[(0,l.Lk)("button",{class:"btn-primary"},"编辑资料"),(0,l.Lk)("button",{class:"btn-secondary"},"导出数据")],-1))])]),(0,l.Lk)("div",Nt,[(0,l.Lk)("aside",Ot,[(0,l.Lk)("div",Gt,[(0,l.Lk)("div",Qt,[e[17]||(e[17]=(0,l.Lk)("h3",null,"个人信息",-1)),(0,l.Lk)("span",Jt,"最近更新："+(0,k.v_)(n.formatDate(n.userInfo.updatedAt)),1)]),(0,l.Lk)("div",Zt,[(0,l.Lk)("div",as,[e[18]||(e[18]=(0,l.Lk)("span",{class:"info-label"},"用户ID",-1)),(0,l.Lk)("span",es,(0,k.v_)(n.userInfo.userId),1)]),(0,l.Lk)("div",ts,[e[19]||(e[19]=(0,l.Lk)("span",{class:"info-label"},"手机号码",-1)),(0,l.Lk)("span",ss,(0,k.v_)(n.userInfo.phone||"未设置"),1)]),(0,l.Lk)("div",ls,[e[20]||(e[20]=(0,l.Lk)("span",{class:"info-label"},"实名认证",-1)),(0,l.Lk)("span",ns,[(0,l.Lk)("span",{class:(0,k.C4)(n.authStatusClass)},(0,k.v_)(n.authStatusText),3),(0,l.Lk)("span",os,"("+(0,k.v_)(n.userInfo.auth.type||"未认证")+")",1)])]),"pending"===n.userInfo.auth.status?((0,l.uX)(),(0,l.CE)("div",is,[e[21]||(e[21]=(0,l.Lk)("span",{class:"info-label"},"审核进度",-1)),(0,l.Lk)("span",rs,(0,k.v_)(n.userInfo.auth.progress)+"%",1)])):(0,l.Q3)("",!0),n.userInfo.auth.expireWarning?((0,l.uX)(),(0,l.CE)("div",ds,[e[22]||(e[22]=(0,l.Lk)("span",{class:"info-label"},"过期提醒",-1)),(0,l.Lk)("span",cs," 证件将在"+(0,k.v_)(n.userInfo.auth.expireDays)+"天后过期 ",1)])):(0,l.Q3)("",!0),(0,l.Lk)("div",us,[e[24]||(e[24]=(0,l.Lk)("span",{class:"info-label"},"最近登录",-1)),(0,l.Lk)("span",vs,[(0,l.eW)((0,k.v_)(n.formatDate(n.userInfo.lastLogin.time))+" ",1),e[23]||(e[23]=(0,l.Lk)("br",null,null,-1)),(0,l.eW)((0,k.v_)(n.userInfo.lastLogin.location),1)])])])]),(0,l.Lk)("div",ps,[e[25]||(e[25]=(0,l.Lk)("div",{class:"card-header"},[(0,l.Lk)("h3",null,"登录设备")],-1)),(0,l.Lk)("div",ms,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.userInfo.loginDevices,a=>((0,l.uX)(),(0,l.CE)("div",{key:a.id,class:"device-item"},[(0,l.Lk)("span",hs,(0,k.v_)(a.name)+"（"+(0,k.v_)(a.os)+"）",1),a.isCurrent?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("button",{key:0,class:"force-logout",onClick:e=>n.handleForceLogout(a.id)}," 强制下线 ",8,bs))]))),128))])])]),(0,l.Lk)("main",ks,[(0,l.Lk)("section",gs,[e[38]||(e[38]=(0,l.Lk)("div",{class:"section-header"},[(0,l.Lk)("h2",{class:"section-title"},"数据概览")],-1)),(0,l.Lk)("div",fs,[(0,l.Lk)("div",Ls,[e[28]||(e[28]=(0,l.Lk)("div",{class:"stat-icon"},[(0,l.Lk)("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[(0,l.Lk)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"})])],-1)),(0,l.Lk)("div",_s,[e[26]||(e[26]=(0,l.Lk)("h4",null,"今日作业面积",-1)),(0,l.Lk)("div",ys,(0,k.v_)(a.todayWorkArea)+"亩",1),e[27]||(e[27]=(0,l.Lk)("div",{class:"stat-trend positive"},"+12% 较昨日",-1))])]),(0,l.Lk)("div",ws,[e[31]||(e[31]=(0,l.Lk)("div",{class:"stat-icon"},[(0,l.Lk)("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[(0,l.Lk)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})])],-1)),(0,l.Lk)("div",Cs,[e[29]||(e[29]=(0,l.Lk)("h4",null,"异常事件",-1)),(0,l.Lk)("div",Fs,(0,k.v_)(a.abnormalEvents),1),e[30]||(e[30]=(0,l.Lk)("div",{class:"stat-trend negative"},"+3 今日",-1))])]),(0,l.Lk)("div",Rs,[e[34]||(e[34]=(0,l.Lk)("div",{class:"stat-icon"},[(0,l.Lk)("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[(0,l.Lk)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})])],-1)),(0,l.Lk)("div",xs,[e[32]||(e[32]=(0,l.Lk)("h4",null,"在线传感器",-1)),(0,l.Lk)("div",Ds,(0,k.v_)(n.onlineSensors),1),e[33]||(e[33]=(0,l.Lk)("div",{class:"stat-trend neutral"},"98% 在线率",-1))])]),(0,l.Lk)("div",Es,[e[37]||(e[37]=(0,l.Lk)("div",{class:"stat-icon"},[(0,l.Lk)("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[(0,l.Lk)("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})])],-1)),(0,l.Lk)("div",Ws,[e[35]||(e[35]=(0,l.Lk)("h4",null,"运行中无人机",-1)),(0,l.Lk)("div",Is,(0,k.v_)(n.runningDrones),1),e[36]||(e[36]=(0,l.Lk)("div",{class:"stat-trend positive"},"+5% 本周",-1))])])])]),(0,l.Lk)("section",Ss,[e[39]||(e[39]=(0,l.Lk)("div",{class:"section-header"},[(0,l.Lk)("h2",{class:"section-title"},"作物生长曲线")],-1)),(0,l.Lk)("div",Ts,[(0,l.Lk)("canvas",$s,null,512)])]),(0,l.Lk)("section",As,[e[45]||(e[45]=(0,l.Fv)('<div class="section-header" data-v-d42fb64e><h2 class="section-title" data-v-d42fb64e>我的种植园</h2><div class="header-actions" data-v-d42fb64e><button class="btn-filter" data-v-d42fb64e>筛选</button><button class="btn-add" data-v-d42fb64e>新建种植园</button></div></div>',1)),(0,l.Lk)("div",Vs,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.userInfo.plantations,a=>((0,l.uX)(),(0,l.CE)("div",{key:a.id,class:"plantation-card"},[(0,l.Lk)("div",Ms,[(0,l.Lk)("img",{src:a.imageUrl,alt:"种植园图片",class:"plantation-img",onError:e[4]||(e[4]=a=>a.target.src=n.defaultPlantationImg)},null,40,Xs),(0,l.Lk)("div",Ks,[(0,l.Lk)("span",{class:(0,k.C4)(["status-badge",n.badgeClass(a.status,"deploy")])},(0,k.v_)(n.deployStatusText(a.status)),3)])]),(0,l.Lk)("div",Ps,[(0,l.Lk)("h3",Bs,(0,k.v_)(a.name),1),(0,l.Lk)("p",Us,(0,k.v_)(a.province)+" "+(0,k.v_)(a.city),1),(0,l.Lk)("div",Ys,[(0,l.Lk)("div",zs,[(0,l.Lk)("span",qs,(0,k.v_)(a.droneCount),1),e[40]||(e[40]=(0,l.Lk)("span",{class:"metric-label"},"无人机",-1))]),(0,l.Lk)("div",Hs,[(0,l.Lk)("span",js,(0,k.v_)(a.sensorCount),1),e[41]||(e[41]=(0,l.Lk)("span",{class:"metric-label"},"传感器",-1))]),(0,l.Lk)("div",Ns,[(0,l.Lk)("span",Os,(0,k.v_)(a.area)+"亩",1),e[42]||(e[42]=(0,l.Lk)("span",{class:"metric-label"},"面积",-1))])]),(0,l.Lk)("div",Gs,[e[43]||(e[43]=(0,l.Lk)("span",{class:"pest-label"},"虫害状态：",-1)),(0,l.Lk)("span",{class:(0,k.C4)(["pest-badge",n.badgeClass(a.pestStatus,"pest")])},(0,k.v_)(n.pestStatusText(a.pestStatus)),3)])]),e[44]||(e[44]=(0,l.Lk)("div",{class:"card-actions"},[(0,l.Lk)("button",{class:"btn-view"},"查看详情"),(0,l.Lk)("button",{class:"btn-manage"},"管理")],-1))]))),128))])]),(0,l.Lk)("section",Qs,[(0,l.Lk)("div",Js,[e[46]||(e[46]=(0,l.Lk)("h2",{class:"section-title"},"设备池",-1)),(0,l.Lk)("div",Zs,[(0,l.Lk)("button",{class:"btn-view-all",onClick:e[5]||(e[5]=(...a)=>n.handleViewAllPlantations&&n.handleViewAllPlantations(...a))}," 查看所有茶园 ")])]),(0,l.Lk)("div",al,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.userInfo.plantations,a=>((0,l.uX)(),(0,l.CE)("div",{key:a.id,class:"plantation-device-group"},[(0,l.Lk)("div",el,(0,k.v_)(a.name)+"（无人机: "+(0,k.v_)(a.droneCount)+" | 传感器: "+(0,k.v_)(a.sensorCount)+"） ",1),(0,l.Lk)("div",tl,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.getDevicesByPlantation(a.id),a=>((0,l.uX)(),(0,l.CE)("div",{key:a.id,class:"device-card"},[(0,l.Lk)("div",sl,(0,k.v_)("drone"===a.type?"无人机":"sensor"===a.type?"传感器":"网关"),1),(0,l.Lk)("div",ll,(0,k.v_)(a.name),1),(0,l.Lk)("div",{class:(0,k.C4)(["device-status",a.status])},(0,k.v_)("online"===a.status?"在线":"离线"),3),(0,l.Lk)("div",nl,[(0,l.eW)(" 固件："+(0,k.v_)(a.firmwareVersion)+" ",1),a.needsUpgrade?((0,l.uX)(),(0,l.CE)("button",ol,"升级")):(0,l.Q3)("",!0)])]))),128))])]))),128)),0===n.userInfo.plantations.length?((0,l.uX)(),(0,l.CE)("div",il,e[47]||(e[47]=[(0,l.Lk)("p",null,"暂无设备数据",-1)]))):(0,l.Q3)("",!0)])]),(0,l.Lk)("section",rl,[e[49]||(e[49]=(0,l.Lk)("div",{class:"section-header"},[(0,l.Lk)("h2",{class:"section-title"},"库存与农资")],-1)),(0,l.Lk)("div",dl,[e[48]||(e[48]=(0,l.Lk)("div",{class:"inventory-header"},[(0,l.Lk)("div",null,"类型"),(0,l.Lk)("div",null,"数量"),(0,l.Lk)("div",null,"阈值"),(0,l.Lk)("div",null,"状态")],-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.userInfo.inventory,a=>((0,l.uX)(),(0,l.CE)("div",{key:a.id,class:"inventory-row"},[(0,l.Lk)("div",null,(0,k.v_)(a.type),1),(0,l.Lk)("div",null,(0,k.v_)(a.quantity),1),(0,l.Lk)("div",null,(0,k.v_)(a.threshold),1),(0,l.Lk)("div",{class:(0,k.C4)(a.quantity<a.threshold?"warning":"normal")},(0,k.v_)(a.quantity<a.threshold?"库存不足":"正常"),3)]))),128))])])])])]))])}var ul={setup(){const a=(0,n.KR)(!0),e=(0,n.KR)({}),t="https://i.pravatar.cc/300",s="https://picsum.photos/400/200?grayscale",o=(0,n.KR)(null),i={group:"集团管理员",subcompany:"子公司经理",farmer:"农场主"},r=(0,l.EW)(()=>e.value.plantations?.reduce((a,e)=>a+e.droneCount,0)||0),d=(0,l.EW)(()=>e.value.plantations?.reduce((a,e)=>a+e.sensorCount,0)||0),c=(0,l.EW)(()=>e.value.plantations?.reduce((a,e)=>a+e.onlineSensors,0)||0),u=(0,l.EW)(()=>e.value.plantations?.reduce((a,e)=>a+e.runningDrones,0)||0),v=(0,l.EW)(()=>{const a=e.value.auth?.status,t={verified:"已认证",pending:"审核中",rejected:"未通过",expired:"已过期"};return t[a]||"未认证"}),p=(0,l.EW)(()=>{const a=e.value.auth?.status,t={verified:"auth-success",pending:"auth-pending",rejected:"auth-failed",expired:"auth-expired"};return t[a]||"auth-none"}),m=a=>e.value.devices?.filter(e=>e.plantationId===a)||[],h=()=>{console.log("跳转至所有茶园页面")},b=async()=>{await new Promise(a=>setTimeout(a,1500)),e.value={userId:"AGR2025001",nickname:"智慧茶园主",username:"tea_farmer",avatar:"https://i.pravatar.cc/300?img=23",phone:"138****6789",onlineStatus:"online",updatedAt:"2025-08-10T14:30:00",lastLogin:{time:"2025-08-12T08:45:00",location:"杭州市-移动网络"},loginDevices:[{id:"d1",name:"Chrome浏览器",os:"Windows 10",isCurrent:!0},{id:"d2",name:"iPhone客户端",os:"iOS 17",isCurrent:!1}],roles:[{code:"group",name:"集团管理员"},{code:"farmer",name:"农场主"}],currentRole:"farmer",auth:{status:"verified",type:"个人证件",progress:100,expireWarning:!0,expireDays:30},todayWorkArea:256,abnormalEvents:3,plantations:[{id:"p1",name:"西湖龙井茶园",imageUrl:"https://picsum.photos/400/200?random=1",province:"浙江省",city:"杭州市",droneCount:3,runningDrones:2,sensorCount:12,onlineSensors:11,area:150,status:2,pestStatus:0},{id:"p2",name:"安溪铁观音基地",imageUrl:"https://picsum.photos/400/200?random=2",province:"福建省",city:"泉州市",droneCount:2,runningDrones:1,sensorCount:8,onlineSensors:8,area:200,status:2,pestStatus:1}],devices:[{id:"dev1",type:"drone",name:"DJI T60",status:"online",firmwareVersion:"v2.3.0",needsUpgrade:!1,plantationId:"p1"},{id:"dev2",type:"sensor",name:"土壤湿度传感器",status:"online",firmwareVersion:"v1.5.2",needsUpgrade:!0,plantationId:"p1"},{id:"dev3",type:"gateway",name:"数据网关",status:"offline",firmwareVersion:"v3.1.0",needsUpgrade:!1,plantationId:"p2"},{id:"dev4",type:"drone",name:"DJI M300",status:"online",firmwareVersion:"v2.1.0",needsUpgrade:!0,plantationId:"p2"}],inventory:[{id:"i1",type:"龙井种子",quantity:50,threshold:30,unit:"kg"},{id:"i2",type:"有机化肥",quantity:25,threshold:40,unit:"袋"},{id:"i3",type:"绿色农药",quantity:8,threshold:10,unit:"瓶"}]},a.value=!1,await(0,l.dY)(),k()},k=()=>{if(console.log("Initializing growth chart..."),console.log("growthChart ref:",o.value),!o.value)return console.warn("Canvas element not found, retrying in 100ms..."),void setTimeout(k,100);try{const a=o.value.getContext("2d");new Ue.Ay(a,{type:"line",data:{labels:["1月","2月","3月","4月","5月","6月"],datasets:e.value.plantations.map((a,e)=>({label:a.name,data:[30*Math.random()+50,30*Math.random()+60,30*Math.random()+70,30*Math.random()+80,30*Math.random()+85,30*Math.random()+90],borderColor:0===e?"#3e95cd":"#8e5ea2",tension:.3,fill:!1}))},options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"作物生长指数趋势"}},scales:{y:{beginAtZero:!1,min:50}}}})}catch(a){console.error("Failed to initialize chart:",a)}},g=a=>{a.target.src=t},f=a=>{const t=a.target.files[0];if(t){const a=new FileReader;a.onload=a=>{e.value.avatar=a.target.result},a.readAsDataURL(t)}},L=async a=>{const t=a.target.value;e.value.currentRole=t},_=async a=>{confirm("确定要强制该设备下线吗？")&&(e.value.loginDevices=e.value.loginDevices.filter(e=>e.id!==a))},y=a=>a?new Date(a).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"",w=a=>["未部署","部署中","已部署"][a]||"未知",C=a=>["无","轻微","中等","严重"][a]||"未知",F=(a,e)=>"deploy"===e?["status-pending","status-processing","status-success"][a]||"":["pest-none","pest-minor","pest-medium","pest-severe"][a]||"";return(0,l.sV)(b),{loading:a,userInfo:e,defaultAvatar:t,defaultPlantationImg:s,growthChart:o,roleMap:i,totalDrones:r,totalSensors:d,onlineSensors:c,runningDrones:u,authStatusText:v,authStatusClass:p,handleAvatarError:g,handleAvatarSelect:f,handleRoleChange:L,handleForceLogout:_,formatDate:y,deployStatusText:w,pestStatusText:C,getDevicesByPlantation:m,handleViewAllPlantations:h,badgeClass:F}}};const vl=(0,u.A)(ul,[["render",cl],["__scopeId","data-v-d42fb64e"]]);var pl=vl;const ml=[{path:"/",name:"auth",component:ea,meta:{showNavbar:!1}},{path:"/home",name:"home",component:B,meta:{showNavbar:!0}},{path:"/manage",name:"manage",component:Sa,meta:{showNavbar:!0}},{path:"/dashboard",name:"dashboard",component:Ge,meta:{showNavbar:!0}},{path:"/monitor",name:"monitor",component:ht,meta:{showNavbar:!0}},{path:"/person",name:"person",component:pl,meta:{showNavbar:!0}},{path:"/:pathMatch(.*)*",redirect:"/"}],hl=(0,o.aE)({history:(0,o.LA)(),routes:ml});var bl=hl,kl=t(5156),gl=(t(4188),t(5186));const fl=(0,s.Ef)(b),Ll=(0,ta.Ey)();for(const[_l,yl]of Object.entries(da))fl.component(_l,yl);fl.use(Ll),fl.use(bl),fl.use(kl.A,{locale:gl.A}),fl.mount("#app")}},e={};function t(s){var l=e[s];if(void 0!==l)return l.exports;var n=e[s]={exports:{}};return a[s].call(n.exports,n,n.exports,t),n.exports}t.m=a,function(){var a=[];t.O=function(e,s,l,n){if(!s){var o=1/0;for(c=0;c<a.length;c++){s=a[c][0],l=a[c][1],n=a[c][2];for(var i=!0,r=0;r<s.length;r++)(!1&n||o>=n)&&Object.keys(t.O).every(function(a){return t.O[a](s[r])})?s.splice(r--,1):(i=!1,n<o&&(o=n));if(i){a.splice(c--,1);var d=l();void 0!==d&&(e=d)}}return e}n=n||0;for(var c=a.length;c>0&&a[c-1][2]>n;c--)a[c]=a[c-1];a[c]=[s,l,n]}}(),function(){t.n=function(a){var e=a&&a.__esModule?function(){return a["default"]}:function(){return a};return t.d(e,{a:e}),e}}(),function(){t.d=function(a,e){for(var s in e)t.o(e,s)&&!t.o(a,s)&&Object.defineProperty(a,s,{enumerable:!0,get:e[s]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(a){if("object"===typeof window)return window}}()}(),function(){t.o=function(a,e){return Object.prototype.hasOwnProperty.call(a,e)}}(),function(){t.r=function(a){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})}}(),function(){var a={524:0};t.O.j=function(e){return 0===a[e]};var e=function(e,s){var l,n,o=s[0],i=s[1],r=s[2],d=0;if(o.some(function(e){return 0!==a[e]})){for(l in i)t.o(i,l)&&(t.m[l]=i[l]);if(r)var c=r(t)}for(e&&e(s);d<o.length;d++)n=o[d],t.o(a,n)&&a[n]&&a[n][0](),a[n]=0;return t.O(c)},s=self["webpackChunksb"]=self["webpackChunksb"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=t.O(void 0,[504],function(){return t(4975)});s=t.O(s)})();
//# sourceMappingURL=app.3533867f.js.map